<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sreenath Krishnan Potty">
<meta name="dcterms.date" content="2023-11-08">

<title>Machine Learning - Time Series Anomaly Detection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Machine Learning</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About Me</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Time Series Anomaly Detection</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Anomaly Detection</div>
    <div class="quarto-category">Time series</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sreenath Krishnan Potty </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 8, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>This blog provides a comprehensive demonstration of loading, visualizing, and analyzing time-series data in Python. It walks through the process of training a Convolutional LSTM Autoencoder model for anomaly detection in time-series data. The script illustrates how to evaluate the model’s performance and establish a threshold for detecting anomalies based on the model’s reconstruction error. The model is specifically trained to reconstruct normal time-series data, and it is designed to exhibit a higher reconstruction error for data that deviates from the established norm, enabling effective anomaly detection.</p>
<section id="importing-libraries" class="level1">
<h1>Importing Libraries</h1>
<p>The script commences by importing essential libraries for various tasks. NumPy is utilized for numerical operations, Pandas for data manipulation and analysis, TensorFlow for machine learning, and Matplotlib for plotting data. These libraries collectively provide the functionality required for numerical operations, data analysis, machine learning, and data visualization in the subsequent sections of the script.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> dates <span class="im">as</span> md</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:From C:\Users\USER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.
</code></pre>
</div>
</div>
</section>
<section id="exploring-dataset-and-visualization" class="level1">
<h1>Exploring Dataset and Visualization</h1>
<p>The script indicates the utilization of the Numenta Anomaly Benchmark (NAB) dataset. This dataset offers artificial time-series data that includes labeled anomalous periods of behavior. The data is organized, timestamped, and comprises single-valued metrics, making it suitable for tasks related to time-series anomaly detection. The data is then visualized. We will be using the time series data without anomalies for training(small_noise) and with anomalies for testing(daily_jumpsup).</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>master_url_root <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/numenta/NAB/master/data/"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df_small_noise_url_suffix <span class="op">=</span> <span class="st">"artificialNoAnomaly/art_daily_small_noise.csv"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>df_small_noise_url <span class="op">=</span> master_url_root <span class="op">+</span> df_small_noise_url_suffix</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df_small_noise <span class="op">=</span> pd.read_csv(df_small_noise_url)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>df_daily_jumpsup_url_suffix <span class="op">=</span> <span class="st">"artificialWithAnomaly/art_daily_jumpsup.csv"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>df_daily_jumpsup_url <span class="op">=</span> master_url_root <span class="op">+</span> df_daily_jumpsup_url_suffix</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>df_daily_jumpsup <span class="op">=</span> pd.read_csv(df_daily_jumpsup_url)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_dates_values(data):</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    dates <span class="op">=</span> data[<span class="st">"timestamp"</span>].to_list()</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> data[<span class="st">"value"</span>].to_list()</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    dates <span class="op">=</span> [datetime.strptime(x, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>) <span class="cf">for</span> x <span class="kw">in</span> dates]</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    plt.subplots_adjust(bottom<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.gca()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    xfmt <span class="op">=</span> md.DateFormatter(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_formatter(xfmt)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    plt.plot(dates, values)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plot_dates_values(df_small_noise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-3-output-1.png" width="626" height="426"></p>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plot_dates_values(df_daily_jumpsup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-4-output-1.png" width="626" height="426"></p>
</div>
</div>
</section>
<section id="normalizing-data-creating-sequences-and-defining-model" class="level1">
<h1>Normalizing Data, Creating Sequences, and Defining Model</h1>
<p>The script proceeds by normalizing the values column from the training DataFrame and preserving the mean and standard deviation for subsequent use. Following this, sequences of time-series data are generated to serve as input to the model. The script then defines a Convolutional LSTM Autoencoder model, a model type frequently employed for anomaly detection in time-series data.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_value_from_df(df):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.value.to_list()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize(values):</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> np.mean(values)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    values <span class="op">-=</span> mean</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    std <span class="op">=</span> np.std(values)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    values <span class="op">/=</span> std</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> values, mean, std</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the `value` column from the training dataframe.</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>training_value <span class="op">=</span> get_value_from_df(df_small_noise)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize `value` and save the mean and std we get,</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># for normalizing test data.</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>training_value, training_mean, training_std <span class="op">=</span> normalize(training_value)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(training_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>4032</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>TIME_STEPS <span class="op">=</span> <span class="dv">288</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_sequences(values, time_steps<span class="op">=</span>TIME_STEPS):</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> []</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(values) <span class="op">-</span> time_steps):</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        output.append(values[i : (i <span class="op">+</span> time_steps)])</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert 2D sequences into 3D as we will be feeding this into</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a convolutional layer.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.expand_dims(output, axis<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> create_sequences(training_value)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training input shape: "</span>, x_train.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training input shape:  (3744, 288, 1)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n_steps <span class="op">=</span> x_train.shape[<span class="dv">1</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>n_features <span class="op">=</span> x_train.shape[<span class="dv">2</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>keras.backend.clear_session()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        layers.Input(shape<span class="op">=</span>(n_steps, n_features)),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        layers.Conv1D(filters<span class="op">=</span><span class="dv">32</span>, kernel_size<span class="op">=</span><span class="dv">15</span>, padding<span class="op">=</span><span class="st">'same'</span>, data_format<span class="op">=</span><span class="st">'channels_last'</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>            dilation_rate<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">"linear"</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        layers.LSTM(</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>            units<span class="op">=</span><span class="dv">25</span>, activation<span class="op">=</span><span class="st">"tanh"</span>, name<span class="op">=</span><span class="st">"lstm_1"</span>, return_sequences<span class="op">=</span><span class="va">False</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        layers.RepeatVector(n_steps),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        layers.LSTM(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>            units<span class="op">=</span><span class="dv">25</span>, activation<span class="op">=</span><span class="st">"tanh"</span>, name<span class="op">=</span><span class="st">"lstm_2"</span>, return_sequences<span class="op">=</span><span class="va">True</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        layers.Conv1D(filters<span class="op">=</span><span class="dv">32</span>, kernel_size<span class="op">=</span><span class="dv">15</span>, padding<span class="op">=</span><span class="st">'same'</span>, data_format<span class="op">=</span><span class="st">'channels_last'</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            dilation_rate<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">"linear"</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        layers.TimeDistributed(layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span>keras.optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">0.001</span>), loss<span class="op">=</span><span class="st">"mse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:From C:\Users\USER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.
</code></pre>
</div>
</div>
</section>
<section id="training-validating-and-detecting-anomalies" class="level1">
<h1>Training, Validating, and Detecting Anomalies</h1>
<p>The script proceeds to train the model on the training data and generates plots illustrating the training and validation loss. Subsequently, it computes the mean absolute error of the model’s predictions on the training data and generates a histogram of the errors. Additionally, the script calculates a threshold for identifying anomalies based on the maximum error. This threshold serves as a criterion to distinguish anomalies in the time-series data.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    x_train,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    x_train,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">200</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">128</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    validation_split<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    callbacks<span class="op">=</span>[</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        keras.callbacks.EarlyStopping(monitor<span class="op">=</span><span class="st">"val_loss"</span>, patience<span class="op">=</span><span class="dv">25</span>, mode<span class="op">=</span><span class="st">"min"</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">"loss"</span>], label<span class="op">=</span><span class="st">"Training Loss"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">"val_loss"</span>], label<span class="op">=</span><span class="st">"Validation Loss"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/200
WARNING:tensorflow:From C:\Users\USER\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

 1/27 [&gt;.............................] - ETA: 1:46 - loss: 1.0380 2/27 [=&gt;............................] - ETA: 4s - loss: 1.0191   3/27 [==&gt;...........................] - ETA: 4s - loss: 1.0177 4/27 [===&gt;..........................] - ETA: 4s - loss: 1.0154 5/27 [====&gt;.........................] - ETA: 3s - loss: 1.0117 6/27 [=====&gt;........................] - ETA: 3s - loss: 1.0095 7/27 [======&gt;.......................] - ETA: 3s - loss: 1.0084 8/27 [=======&gt;......................] - ETA: 3s - loss: 1.0074 9/27 [=========&gt;....................] - ETA: 3s - loss: 1.006410/27 [==========&gt;...................] - ETA: 2s - loss: 1.005211/27 [===========&gt;..................] - ETA: 2s - loss: 1.004412/27 [============&gt;.................] - ETA: 2s - loss: 1.003613/27 [=============&gt;................] - ETA: 2s - loss: 1.003114/27 [==============&gt;...............] - ETA: 2s - loss: 1.002415/27 [===============&gt;..............] - ETA: 2s - loss: 1.001716/27 [================&gt;.............] - ETA: 1s - loss: 1.001217/27 [=================&gt;............] - ETA: 1s - loss: 1.000818/27 [===================&gt;..........] - ETA: 1s - loss: 1.000319/27 [====================&gt;.........] - ETA: 1s - loss: 0.999820/27 [=====================&gt;........] - ETA: 1s - loss: 0.999321/27 [======================&gt;.......] - ETA: 1s - loss: 0.998822/27 [=======================&gt;......] - ETA: 0s - loss: 0.998523/27 [========================&gt;.....] - ETA: 0s - loss: 0.998024/27 [=========================&gt;....] - ETA: 0s - loss: 0.997525/27 [==========================&gt;...] - ETA: 0s - loss: 0.997026/27 [===========================&gt;..] - ETA: 0s - loss: 0.996427/27 [==============================] - ETA: 0s - loss: 0.996227/27 [==============================] - 10s 213ms/step - loss: 0.9962 - val_loss: 0.9933
Epoch 2/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.9821 2/27 [=&gt;............................] - ETA: 3s - loss: 0.9825 3/27 [==&gt;...........................] - ETA: 3s - loss: 0.9805 4/27 [===&gt;..........................] - ETA: 3s - loss: 0.9792 5/27 [====&gt;.........................] - ETA: 3s - loss: 0.9778 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.9769 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.9756 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.9739 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.972710/27 [==========&gt;...................] - ETA: 2s - loss: 0.971211/27 [===========&gt;..................] - ETA: 2s - loss: 0.969512/27 [============&gt;.................] - ETA: 2s - loss: 0.968313/27 [=============&gt;................] - ETA: 2s - loss: 0.966614/27 [==============&gt;...............] - ETA: 2s - loss: 0.965015/27 [===============&gt;..............] - ETA: 2s - loss: 0.963216/27 [================&gt;.............] - ETA: 1s - loss: 0.961317/27 [=================&gt;............] - ETA: 1s - loss: 0.959918/27 [===================&gt;..........] - ETA: 1s - loss: 0.959019/27 [====================&gt;.........] - ETA: 1s - loss: 0.957920/27 [=====================&gt;........] - ETA: 1s - loss: 0.957421/27 [======================&gt;.......] - ETA: 1s - loss: 0.956222/27 [=======================&gt;......] - ETA: 0s - loss: 0.954723/27 [========================&gt;.....] - ETA: 0s - loss: 0.954624/27 [=========================&gt;....] - ETA: 0s - loss: 0.952825/27 [==========================&gt;...] - ETA: 0s - loss: 0.952126/27 [===========================&gt;..] - ETA: 0s - loss: 0.950727/27 [==============================] - ETA: 0s - loss: 0.950827/27 [==============================] - 5s 173ms/step - loss: 0.9508 - val_loss: 0.9497
Epoch 3/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.9237 2/27 [=&gt;............................] - ETA: 4s - loss: 0.9227 3/27 [==&gt;...........................] - ETA: 3s - loss: 0.9197 4/27 [===&gt;..........................] - ETA: 3s - loss: 0.9237 5/27 [====&gt;.........................] - ETA: 3s - loss: 0.9251 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.9209 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.9184 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.9153 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.915410/27 [==========&gt;...................] - ETA: 2s - loss: 0.913211/27 [===========&gt;..................] - ETA: 2s - loss: 0.913412/27 [============&gt;.................] - ETA: 2s - loss: 0.912513/27 [=============&gt;................] - ETA: 2s - loss: 0.911214/27 [==============&gt;...............] - ETA: 2s - loss: 0.910115/27 [===============&gt;..............] - ETA: 2s - loss: 0.909216/27 [================&gt;.............] - ETA: 1s - loss: 0.910217/27 [=================&gt;............] - ETA: 1s - loss: 0.910318/27 [===================&gt;..........] - ETA: 1s - loss: 0.909719/27 [====================&gt;.........] - ETA: 1s - loss: 0.908920/27 [=====================&gt;........] - ETA: 1s - loss: 0.908421/27 [======================&gt;.......] - ETA: 1s - loss: 0.908322/27 [=======================&gt;......] - ETA: 0s - loss: 0.908223/27 [========================&gt;.....] - ETA: 0s - loss: 0.907224/27 [=========================&gt;....] - ETA: 0s - loss: 0.906525/27 [==========================&gt;...] - ETA: 0s - loss: 0.906326/27 [===========================&gt;..] - ETA: 0s - loss: 0.906527/27 [==============================] - ETA: 0s - loss: 0.906327/27 [==============================] - 5s 177ms/step - loss: 0.9063 - val_loss: 0.9232
Epoch 4/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8829 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8850 3/27 [==&gt;...........................] - ETA: 3s - loss: 0.8882 4/27 [===&gt;..........................] - ETA: 3s - loss: 0.8924 5/27 [====&gt;.........................] - ETA: 3s - loss: 0.8935 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.8884 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8863 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8879 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.887010/27 [==========&gt;...................] - ETA: 2s - loss: 0.884611/27 [===========&gt;..................] - ETA: 2s - loss: 0.884612/27 [============&gt;.................] - ETA: 2s - loss: 0.883913/27 [=============&gt;................] - ETA: 2s - loss: 0.885614/27 [==============&gt;...............] - ETA: 2s - loss: 0.885615/27 [===============&gt;..............] - ETA: 2s - loss: 0.882916/27 [================&gt;.............] - ETA: 1s - loss: 0.883117/27 [=================&gt;............] - ETA: 1s - loss: 0.881518/27 [===================&gt;..........] - ETA: 1s - loss: 0.880619/27 [====================&gt;.........] - ETA: 1s - loss: 0.879720/27 [=====================&gt;........] - ETA: 1s - loss: 0.880021/27 [======================&gt;.......] - ETA: 1s - loss: 0.879922/27 [=======================&gt;......] - ETA: 0s - loss: 0.878423/27 [========================&gt;.....] - ETA: 0s - loss: 0.879124/27 [=========================&gt;....] - ETA: 0s - loss: 0.878825/27 [==========================&gt;...] - ETA: 0s - loss: 0.878626/27 [===========================&gt;..] - ETA: 0s - loss: 0.877727/27 [==============================] - ETA: 0s - loss: 0.877927/27 [==============================] - 5s 181ms/step - loss: 0.8779 - val_loss: 0.9524
Epoch 5/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.9174 2/27 [=&gt;............................] - ETA: 4s - loss: 0.9151 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.9334 4/27 [===&gt;..........................] - ETA: 3s - loss: 0.9265 5/27 [====&gt;.........................] - ETA: 3s - loss: 0.9344 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.9322 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.9366 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.9380 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.938810/27 [==========&gt;...................] - ETA: 2s - loss: 0.938111/27 [===========&gt;..................] - ETA: 2s - loss: 0.937312/27 [============&gt;.................] - ETA: 2s - loss: 0.936113/27 [=============&gt;................] - ETA: 2s - loss: 0.935514/27 [==============&gt;...............] - ETA: 2s - loss: 0.934115/27 [===============&gt;..............] - ETA: 2s - loss: 0.932716/27 [================&gt;.............] - ETA: 2s - loss: 0.932017/27 [=================&gt;............] - ETA: 1s - loss: 0.931418/27 [===================&gt;..........] - ETA: 1s - loss: 0.930019/27 [====================&gt;.........] - ETA: 1s - loss: 0.930120/27 [=====================&gt;........] - ETA: 1s - loss: 0.928421/27 [======================&gt;.......] - ETA: 1s - loss: 0.926922/27 [=======================&gt;......] - ETA: 0s - loss: 0.926123/27 [========================&gt;.....] - ETA: 0s - loss: 0.925224/27 [=========================&gt;....] - ETA: 0s - loss: 0.924125/27 [==========================&gt;...] - ETA: 0s - loss: 0.922926/27 [===========================&gt;..] - ETA: 0s - loss: 0.922027/27 [==============================] - ETA: 0s - loss: 0.921727/27 [==============================] - 5s 194ms/step - loss: 0.9217 - val_loss: 0.9053
Epoch 6/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8930 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8896 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8875 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8890 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8862 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.8855 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8857 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8862 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.886510/27 [==========&gt;...................] - ETA: 3s - loss: 0.885311/27 [===========&gt;..................] - ETA: 3s - loss: 0.885512/27 [============&gt;.................] - ETA: 3s - loss: 0.885313/27 [=============&gt;................] - ETA: 2s - loss: 0.884014/27 [==============&gt;...............] - ETA: 2s - loss: 0.884015/27 [===============&gt;..............] - ETA: 2s - loss: 0.885816/27 [================&gt;.............] - ETA: 2s - loss: 0.885217/27 [=================&gt;............] - ETA: 1s - loss: 0.886218/27 [===================&gt;..........] - ETA: 1s - loss: 0.885519/27 [====================&gt;.........] - ETA: 1s - loss: 0.884720/27 [=====================&gt;........] - ETA: 1s - loss: 0.885221/27 [======================&gt;.......] - ETA: 1s - loss: 0.884822/27 [=======================&gt;......] - ETA: 0s - loss: 0.884223/27 [========================&gt;.....] - ETA: 0s - loss: 0.884124/27 [=========================&gt;....] - ETA: 0s - loss: 0.884125/27 [==========================&gt;...] - ETA: 0s - loss: 0.883726/27 [===========================&gt;..] - ETA: 0s - loss: 0.883527/27 [==============================] - ETA: 0s - loss: 0.883427/27 [==============================] - 6s 205ms/step - loss: 0.8834 - val_loss: 0.8996
Epoch 7/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8831 2/27 [=&gt;............................] - ETA: 6s - loss: 0.8766 3/27 [==&gt;...........................] - ETA: 5s - loss: 0.8768 4/27 [===&gt;..........................] - ETA: 5s - loss: 0.8814 5/27 [====&gt;.........................] - ETA: 5s - loss: 0.8756 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8750 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.8769 8/27 [=======&gt;......................] - ETA: 4s - loss: 0.8778 9/27 [=========&gt;....................] - ETA: 4s - loss: 0.877210/27 [==========&gt;...................] - ETA: 3s - loss: 0.875511/27 [===========&gt;..................] - ETA: 3s - loss: 0.874612/27 [============&gt;.................] - ETA: 3s - loss: 0.875213/27 [=============&gt;................] - ETA: 3s - loss: 0.873914/27 [==============&gt;...............] - ETA: 2s - loss: 0.872015/27 [===============&gt;..............] - ETA: 2s - loss: 0.873916/27 [================&gt;.............] - ETA: 2s - loss: 0.871717/27 [=================&gt;............] - ETA: 2s - loss: 0.872918/27 [===================&gt;..........] - ETA: 1s - loss: 0.872719/27 [====================&gt;.........] - ETA: 1s - loss: 0.871820/27 [=====================&gt;........] - ETA: 1s - loss: 0.872421/27 [======================&gt;.......] - ETA: 1s - loss: 0.871222/27 [=======================&gt;......] - ETA: 1s - loss: 0.871223/27 [========================&gt;.....] - ETA: 0s - loss: 0.869324/27 [=========================&gt;....] - ETA: 0s - loss: 0.870225/27 [==========================&gt;...] - ETA: 0s - loss: 0.869226/27 [===========================&gt;..] - ETA: 0s - loss: 0.868127/27 [==============================] - ETA: 0s - loss: 0.868627/27 [==============================] - 6s 211ms/step - loss: 0.8686 - val_loss: 0.8762
Epoch 8/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.8575 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8552 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8527 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8555 5/27 [====&gt;.........................] - ETA: 3s - loss: 0.8520 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.8544 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8578 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8542 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.853810/27 [==========&gt;...................] - ETA: 3s - loss: 0.852611/27 [===========&gt;..................] - ETA: 2s - loss: 0.855012/27 [============&gt;.................] - ETA: 2s - loss: 0.852913/27 [=============&gt;................] - ETA: 2s - loss: 0.852714/27 [==============&gt;...............] - ETA: 2s - loss: 0.849215/27 [===============&gt;..............] - ETA: 2s - loss: 0.849016/27 [================&gt;.............] - ETA: 1s - loss: 0.849317/27 [=================&gt;............] - ETA: 1s - loss: 0.849618/27 [===================&gt;..........] - ETA: 1s - loss: 0.849019/27 [====================&gt;.........] - ETA: 1s - loss: 0.848520/27 [=====================&gt;........] - ETA: 1s - loss: 0.851821/27 [======================&gt;.......] - ETA: 1s - loss: 0.851422/27 [=======================&gt;......] - ETA: 0s - loss: 0.852523/27 [========================&gt;.....] - ETA: 0s - loss: 0.852124/27 [=========================&gt;....] - ETA: 0s - loss: 0.852025/27 [==========================&gt;...] - ETA: 0s - loss: 0.851226/27 [===========================&gt;..] - ETA: 0s - loss: 0.850127/27 [==============================] - ETA: 0s - loss: 0.849927/27 [==============================] - 5s 199ms/step - loss: 0.8499 - val_loss: 0.8569
Epoch 9/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.8501 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8426 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8432 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8436 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8354 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8377 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8406 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8414 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.843710/27 [==========&gt;...................] - ETA: 3s - loss: 0.841211/27 [===========&gt;..................] - ETA: 3s - loss: 0.840912/27 [============&gt;.................] - ETA: 2s - loss: 0.841513/27 [=============&gt;................] - ETA: 2s - loss: 0.843414/27 [==============&gt;...............] - ETA: 2s - loss: 0.842315/27 [===============&gt;..............] - ETA: 2s - loss: 0.842216/27 [================&gt;.............] - ETA: 2s - loss: 0.841817/27 [=================&gt;............] - ETA: 1s - loss: 0.841218/27 [===================&gt;..........] - ETA: 1s - loss: 0.841819/27 [====================&gt;.........] - ETA: 1s - loss: 0.842220/27 [=====================&gt;........] - ETA: 1s - loss: 0.840721/27 [======================&gt;.......] - ETA: 1s - loss: 0.840022/27 [=======================&gt;......] - ETA: 0s - loss: 0.838023/27 [========================&gt;.....] - ETA: 0s - loss: 0.838824/27 [=========================&gt;....] - ETA: 0s - loss: 0.837425/27 [==========================&gt;...] - ETA: 0s - loss: 0.838726/27 [===========================&gt;..] - ETA: 0s - loss: 0.839727/27 [==============================] - ETA: 0s - loss: 0.839227/27 [==============================] - 5s 189ms/step - loss: 0.8392 - val_loss: 0.8610
Epoch 10/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.8341 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8381 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8328 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8351 5/27 [====&gt;.........................] - ETA: 3s - loss: 0.8347 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.8294 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8228 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8213 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.825010/27 [==========&gt;...................] - ETA: 3s - loss: 0.822211/27 [===========&gt;..................] - ETA: 2s - loss: 0.821412/27 [============&gt;.................] - ETA: 2s - loss: 0.820613/27 [=============&gt;................] - ETA: 2s - loss: 0.820914/27 [==============&gt;...............] - ETA: 2s - loss: 0.820215/27 [===============&gt;..............] - ETA: 2s - loss: 0.817816/27 [================&gt;.............] - ETA: 2s - loss: 0.817917/27 [=================&gt;............] - ETA: 1s - loss: 0.818418/27 [===================&gt;..........] - ETA: 1s - loss: 0.818319/27 [====================&gt;.........] - ETA: 1s - loss: 0.817020/27 [=====================&gt;........] - ETA: 1s - loss: 0.815521/27 [======================&gt;.......] - ETA: 1s - loss: 0.816422/27 [=======================&gt;......] - ETA: 0s - loss: 0.817623/27 [========================&gt;.....] - ETA: 0s - loss: 0.817724/27 [=========================&gt;....] - ETA: 0s - loss: 0.817625/27 [==========================&gt;...] - ETA: 0s - loss: 0.819026/27 [===========================&gt;..] - ETA: 0s - loss: 0.821127/27 [==============================] - ETA: 0s - loss: 0.822327/27 [==============================] - 5s 190ms/step - loss: 0.8223 - val_loss: 0.8978
Epoch 11/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.8782 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8687 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8749 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8700 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8596 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.8482 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8508 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8450 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.841110/27 [==========&gt;...................] - ETA: 3s - loss: 0.841911/27 [===========&gt;..................] - ETA: 2s - loss: 0.843112/27 [============&gt;.................] - ETA: 2s - loss: 0.841313/27 [=============&gt;................] - ETA: 2s - loss: 0.839914/27 [==============&gt;...............] - ETA: 2s - loss: 0.840115/27 [===============&gt;..............] - ETA: 2s - loss: 0.839716/27 [================&gt;.............] - ETA: 2s - loss: 0.838317/27 [=================&gt;............] - ETA: 1s - loss: 0.836018/27 [===================&gt;..........] - ETA: 1s - loss: 0.835219/27 [====================&gt;.........] - ETA: 1s - loss: 0.833420/27 [=====================&gt;........] - ETA: 1s - loss: 0.834821/27 [======================&gt;.......] - ETA: 1s - loss: 0.832822/27 [=======================&gt;......] - ETA: 0s - loss: 0.831723/27 [========================&gt;.....] - ETA: 0s - loss: 0.832524/27 [=========================&gt;....] - ETA: 0s - loss: 0.830325/27 [==========================&gt;...] - ETA: 0s - loss: 0.830726/27 [===========================&gt;..] - ETA: 0s - loss: 0.830327/27 [==============================] - ETA: 0s - loss: 0.829827/27 [==============================] - 5s 191ms/step - loss: 0.8298 - val_loss: 0.8376
Epoch 12/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.8052 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7961 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8063 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8072 5/27 [====&gt;.........................] - ETA: 3s - loss: 0.8164 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.8122 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8145 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8151 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.817310/27 [==========&gt;...................] - ETA: 3s - loss: 0.815311/27 [===========&gt;..................] - ETA: 2s - loss: 0.814912/27 [============&gt;.................] - ETA: 2s - loss: 0.814413/27 [=============&gt;................] - ETA: 2s - loss: 0.814514/27 [==============&gt;...............] - ETA: 2s - loss: 0.812815/27 [===============&gt;..............] - ETA: 2s - loss: 0.811416/27 [================&gt;.............] - ETA: 2s - loss: 0.810117/27 [=================&gt;............] - ETA: 1s - loss: 0.810818/27 [===================&gt;..........] - ETA: 1s - loss: 0.808319/27 [====================&gt;.........] - ETA: 1s - loss: 0.808720/27 [=====================&gt;........] - ETA: 1s - loss: 0.808921/27 [======================&gt;.......] - ETA: 1s - loss: 0.809922/27 [=======================&gt;......] - ETA: 0s - loss: 0.808523/27 [========================&gt;.....] - ETA: 0s - loss: 0.808524/27 [=========================&gt;....] - ETA: 0s - loss: 0.807225/27 [==========================&gt;...] - ETA: 0s - loss: 0.807426/27 [===========================&gt;..] - ETA: 0s - loss: 0.805627/27 [==============================] - ETA: 0s - loss: 0.805027/27 [==============================] - 5s 189ms/step - loss: 0.8050 - val_loss: 0.8092
Epoch 13/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.8003 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8049 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7975 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7969 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7928 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7957 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7949 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7941 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.793710/27 [==========&gt;...................] - ETA: 3s - loss: 0.790411/27 [===========&gt;..................] - ETA: 3s - loss: 0.788212/27 [============&gt;.................] - ETA: 2s - loss: 0.786213/27 [=============&gt;................] - ETA: 2s - loss: 0.786114/27 [==============&gt;...............] - ETA: 2s - loss: 0.786715/27 [===============&gt;..............] - ETA: 2s - loss: 0.786916/27 [================&gt;.............] - ETA: 2s - loss: 0.788717/27 [=================&gt;............] - ETA: 1s - loss: 0.790318/27 [===================&gt;..........] - ETA: 1s - loss: 0.791219/27 [====================&gt;.........] - ETA: 1s - loss: 0.794020/27 [=====================&gt;........] - ETA: 1s - loss: 0.795821/27 [======================&gt;.......] - ETA: 1s - loss: 0.798022/27 [=======================&gt;......] - ETA: 0s - loss: 0.798823/27 [========================&gt;.....] - ETA: 0s - loss: 0.798424/27 [=========================&gt;....] - ETA: 0s - loss: 0.799725/27 [==========================&gt;...] - ETA: 0s - loss: 0.798826/27 [===========================&gt;..] - ETA: 0s - loss: 0.800727/27 [==============================] - ETA: 0s - loss: 0.800427/27 [==============================] - 5s 200ms/step - loss: 0.8004 - val_loss: 0.8186
Epoch 14/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8168 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8047 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8071 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8077 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8114 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.8105 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8068 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8060 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.807910/27 [==========&gt;...................] - ETA: 3s - loss: 0.801911/27 [===========&gt;..................] - ETA: 3s - loss: 0.801012/27 [============&gt;.................] - ETA: 2s - loss: 0.802513/27 [=============&gt;................] - ETA: 2s - loss: 0.800414/27 [==============&gt;...............] - ETA: 2s - loss: 0.799015/27 [===============&gt;..............] - ETA: 2s - loss: 0.798516/27 [================&gt;.............] - ETA: 2s - loss: 0.797317/27 [=================&gt;............] - ETA: 1s - loss: 0.794818/27 [===================&gt;..........] - ETA: 1s - loss: 0.793119/27 [====================&gt;.........] - ETA: 1s - loss: 0.793120/27 [=====================&gt;........] - ETA: 1s - loss: 0.792121/27 [======================&gt;.......] - ETA: 1s - loss: 0.788522/27 [=======================&gt;......] - ETA: 0s - loss: 0.789523/27 [========================&gt;.....] - ETA: 0s - loss: 0.786624/27 [=========================&gt;....] - ETA: 0s - loss: 0.786125/27 [==========================&gt;...] - ETA: 0s - loss: 0.785726/27 [===========================&gt;..] - ETA: 0s - loss: 0.784827/27 [==============================] - ETA: 0s - loss: 0.783927/27 [==============================] - 5s 198ms/step - loss: 0.7839 - val_loss: 0.7884
Epoch 15/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.7635 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7669 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7756 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7689 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7688 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.7734 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7684 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7671 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.767010/27 [==========&gt;...................] - ETA: 3s - loss: 0.768311/27 [===========&gt;..................] - ETA: 3s - loss: 0.769212/27 [============&gt;.................] - ETA: 2s - loss: 0.770813/27 [=============&gt;................] - ETA: 2s - loss: 0.771314/27 [==============&gt;...............] - ETA: 2s - loss: 0.772115/27 [===============&gt;..............] - ETA: 2s - loss: 0.772916/27 [================&gt;.............] - ETA: 2s - loss: 0.770717/27 [=================&gt;............] - ETA: 1s - loss: 0.769318/27 [===================&gt;..........] - ETA: 1s - loss: 0.768119/27 [====================&gt;.........] - ETA: 1s - loss: 0.771020/27 [=====================&gt;........] - ETA: 1s - loss: 0.773121/27 [======================&gt;.......] - ETA: 1s - loss: 0.774222/27 [=======================&gt;......] - ETA: 0s - loss: 0.776823/27 [========================&gt;.....] - ETA: 0s - loss: 0.776524/27 [=========================&gt;....] - ETA: 0s - loss: 0.776925/27 [==========================&gt;...] - ETA: 0s - loss: 0.779126/27 [===========================&gt;..] - ETA: 0s - loss: 0.778327/27 [==============================] - ETA: 0s - loss: 0.778027/27 [==============================] - 5s 197ms/step - loss: 0.7780 - val_loss: 0.8070
Epoch 16/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.7848 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7922 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7841 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7872 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7880 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.7859 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7785 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7773 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.775910/27 [==========&gt;...................] - ETA: 3s - loss: 0.775011/27 [===========&gt;..................] - ETA: 2s - loss: 0.771712/27 [============&gt;.................] - ETA: 2s - loss: 0.769913/27 [=============&gt;................] - ETA: 2s - loss: 0.769414/27 [==============&gt;...............] - ETA: 2s - loss: 0.769015/27 [===============&gt;..............] - ETA: 2s - loss: 0.768916/27 [================&gt;.............] - ETA: 2s - loss: 0.768517/27 [=================&gt;............] - ETA: 1s - loss: 0.768918/27 [===================&gt;..........] - ETA: 1s - loss: 0.767519/27 [====================&gt;.........] - ETA: 1s - loss: 0.769320/27 [=====================&gt;........] - ETA: 1s - loss: 0.769621/27 [======================&gt;.......] - ETA: 1s - loss: 0.768622/27 [=======================&gt;......] - ETA: 0s - loss: 0.766823/27 [========================&gt;.....] - ETA: 0s - loss: 0.767424/27 [=========================&gt;....] - ETA: 0s - loss: 0.767225/27 [==========================&gt;...] - ETA: 0s - loss: 0.769826/27 [===========================&gt;..] - ETA: 0s - loss: 0.769127/27 [==============================] - ETA: 0s - loss: 0.769827/27 [==============================] - 5s 193ms/step - loss: 0.7698 - val_loss: 0.7766
Epoch 17/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7710 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7673 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7714 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7797 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7847 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.7772 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7787 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7827 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.782010/27 [==========&gt;...................] - ETA: 3s - loss: 0.782211/27 [===========&gt;..................] - ETA: 3s - loss: 0.783412/27 [============&gt;.................] - ETA: 2s - loss: 0.788413/27 [=============&gt;................] - ETA: 2s - loss: 0.788414/27 [==============&gt;...............] - ETA: 2s - loss: 0.788315/27 [===============&gt;..............] - ETA: 2s - loss: 0.792816/27 [================&gt;.............] - ETA: 2s - loss: 0.791317/27 [=================&gt;............] - ETA: 1s - loss: 0.791018/27 [===================&gt;..........] - ETA: 1s - loss: 0.793019/27 [====================&gt;.........] - ETA: 1s - loss: 0.795120/27 [=====================&gt;........] - ETA: 1s - loss: 0.793921/27 [======================&gt;.......] - ETA: 1s - loss: 0.793122/27 [=======================&gt;......] - ETA: 0s - loss: 0.791223/27 [========================&gt;.....] - ETA: 0s - loss: 0.788324/27 [=========================&gt;....] - ETA: 0s - loss: 0.787425/27 [==========================&gt;...] - ETA: 0s - loss: 0.788326/27 [===========================&gt;..] - ETA: 0s - loss: 0.789127/27 [==============================] - ETA: 0s - loss: 0.789127/27 [==============================] - 5s 192ms/step - loss: 0.7891 - val_loss: 0.7809
Epoch 18/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7222 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7683 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7686 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7658 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7652 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.7672 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7708 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7718 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.770510/27 [==========&gt;...................] - ETA: 3s - loss: 0.771711/27 [===========&gt;..................] - ETA: 2s - loss: 0.772212/27 [============&gt;.................] - ETA: 2s - loss: 0.773013/27 [=============&gt;................] - ETA: 2s - loss: 0.772114/27 [==============&gt;...............] - ETA: 2s - loss: 0.774315/27 [===============&gt;..............] - ETA: 2s - loss: 0.774716/27 [================&gt;.............] - ETA: 2s - loss: 0.770917/27 [=================&gt;............] - ETA: 1s - loss: 0.769118/27 [===================&gt;..........] - ETA: 1s - loss: 0.768319/27 [====================&gt;.........] - ETA: 1s - loss: 0.767320/27 [=====================&gt;........] - ETA: 1s - loss: 0.767821/27 [======================&gt;.......] - ETA: 1s - loss: 0.765822/27 [=======================&gt;......] - ETA: 0s - loss: 0.764723/27 [========================&gt;.....] - ETA: 0s - loss: 0.765524/27 [=========================&gt;....] - ETA: 0s - loss: 0.766025/27 [==========================&gt;...] - ETA: 0s - loss: 0.767126/27 [===========================&gt;..] - ETA: 0s - loss: 0.765327/27 [==============================] - ETA: 0s - loss: 0.764827/27 [==============================] - 5s 194ms/step - loss: 0.7648 - val_loss: 0.7399
Epoch 19/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7733 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7588 3/27 [==&gt;...........................] - ETA: 5s - loss: 0.7593 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7630 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7708 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7690 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.7725 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7772 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.782910/27 [==========&gt;...................] - ETA: 3s - loss: 0.781911/27 [===========&gt;..................] - ETA: 3s - loss: 0.784312/27 [============&gt;.................] - ETA: 2s - loss: 0.783513/27 [=============&gt;................] - ETA: 2s - loss: 0.786114/27 [==============&gt;...............] - ETA: 2s - loss: 0.784615/27 [===============&gt;..............] - ETA: 2s - loss: 0.784016/27 [================&gt;.............] - ETA: 2s - loss: 0.782017/27 [=================&gt;............] - ETA: 1s - loss: 0.782418/27 [===================&gt;..........] - ETA: 1s - loss: 0.781219/27 [====================&gt;.........] - ETA: 1s - loss: 0.781320/27 [=====================&gt;........] - ETA: 1s - loss: 0.778121/27 [======================&gt;.......] - ETA: 1s - loss: 0.776922/27 [=======================&gt;......] - ETA: 0s - loss: 0.774923/27 [========================&gt;.....] - ETA: 0s - loss: 0.773524/27 [=========================&gt;....] - ETA: 0s - loss: 0.774425/27 [==========================&gt;...] - ETA: 0s - loss: 0.772226/27 [===========================&gt;..] - ETA: 0s - loss: 0.769727/27 [==============================] - ETA: 0s - loss: 0.768727/27 [==============================] - 6s 204ms/step - loss: 0.7687 - val_loss: 0.7022
Epoch 20/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.6897 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7169 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7281 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7259 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7349 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7478 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7603 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7667 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.770410/27 [==========&gt;...................] - ETA: 3s - loss: 0.769811/27 [===========&gt;..................] - ETA: 3s - loss: 0.776412/27 [============&gt;.................] - ETA: 2s - loss: 0.779313/27 [=============&gt;................] - ETA: 2s - loss: 0.781914/27 [==============&gt;...............] - ETA: 2s - loss: 0.783715/27 [===============&gt;..............] - ETA: 2s - loss: 0.786816/27 [================&gt;.............] - ETA: 2s - loss: 0.789417/27 [=================&gt;............] - ETA: 1s - loss: 0.789618/27 [===================&gt;..........] - ETA: 1s - loss: 0.790919/27 [====================&gt;.........] - ETA: 1s - loss: 0.790520/27 [=====================&gt;........] - ETA: 1s - loss: 0.791621/27 [======================&gt;.......] - ETA: 1s - loss: 0.791022/27 [=======================&gt;......] - ETA: 0s - loss: 0.790223/27 [========================&gt;.....] - ETA: 0s - loss: 0.790524/27 [=========================&gt;....] - ETA: 0s - loss: 0.790025/27 [==========================&gt;...] - ETA: 0s - loss: 0.789126/27 [===========================&gt;..] - ETA: 0s - loss: 0.788127/27 [==============================] - ETA: 0s - loss: 0.786427/27 [==============================] - 5s 201ms/step - loss: 0.7864 - val_loss: 0.8070
Epoch 21/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7449 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7576 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7580 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7620 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7657 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7661 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7702 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7716 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.769110/27 [==========&gt;...................] - ETA: 3s - loss: 0.769211/27 [===========&gt;..................] - ETA: 3s - loss: 0.771612/27 [============&gt;.................] - ETA: 2s - loss: 0.770613/27 [=============&gt;................] - ETA: 2s - loss: 0.769514/27 [==============&gt;...............] - ETA: 2s - loss: 0.769315/27 [===============&gt;..............] - ETA: 2s - loss: 0.771016/27 [================&gt;.............] - ETA: 2s - loss: 0.772217/27 [=================&gt;............] - ETA: 1s - loss: 0.770718/27 [===================&gt;..........] - ETA: 1s - loss: 0.768719/27 [====================&gt;.........] - ETA: 1s - loss: 0.767020/27 [=====================&gt;........] - ETA: 1s - loss: 0.769621/27 [======================&gt;.......] - ETA: 1s - loss: 0.770022/27 [=======================&gt;......] - ETA: 0s - loss: 0.771223/27 [========================&gt;.....] - ETA: 0s - loss: 0.772924/27 [=========================&gt;....] - ETA: 0s - loss: 0.773725/27 [==========================&gt;...] - ETA: 0s - loss: 0.774926/27 [===========================&gt;..] - ETA: 0s - loss: 0.775827/27 [==============================] - ETA: 0s - loss: 0.776327/27 [==============================] - 5s 196ms/step - loss: 0.7763 - val_loss: 0.8262
Epoch 22/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.7930 2/27 [=&gt;............................] - ETA: 5s - loss: 0.8209 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8291 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8353 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8322 6/27 [=====&gt;........................] - ETA: 3s - loss: 0.8355 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8262 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8317 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.835010/27 [==========&gt;...................] - ETA: 3s - loss: 0.834411/27 [===========&gt;..................] - ETA: 3s - loss: 0.833612/27 [============&gt;.................] - ETA: 2s - loss: 0.834813/27 [=============&gt;................] - ETA: 2s - loss: 0.834914/27 [==============&gt;...............] - ETA: 2s - loss: 0.831715/27 [===============&gt;..............] - ETA: 2s - loss: 0.831116/27 [================&gt;.............] - ETA: 2s - loss: 0.828517/27 [=================&gt;............] - ETA: 1s - loss: 0.829318/27 [===================&gt;..........] - ETA: 1s - loss: 0.827019/27 [====================&gt;.........] - ETA: 1s - loss: 0.826720/27 [=====================&gt;........] - ETA: 1s - loss: 0.824621/27 [======================&gt;.......] - ETA: 1s - loss: 0.822922/27 [=======================&gt;......] - ETA: 0s - loss: 0.821323/27 [========================&gt;.....] - ETA: 0s - loss: 0.819324/27 [=========================&gt;....] - ETA: 0s - loss: 0.818525/27 [==========================&gt;...] - ETA: 0s - loss: 0.817626/27 [===========================&gt;..] - ETA: 0s - loss: 0.814927/27 [==============================] - ETA: 0s - loss: 0.814927/27 [==============================] - 6s 206ms/step - loss: 0.8149 - val_loss: 0.7940
Epoch 23/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.7714 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7659 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7632 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7677 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7582 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7552 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7585 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7554 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.749210/27 [==========&gt;...................] - ETA: 3s - loss: 0.753811/27 [===========&gt;..................] - ETA: 3s - loss: 0.750212/27 [============&gt;.................] - ETA: 2s - loss: 0.751013/27 [=============&gt;................] - ETA: 2s - loss: 0.749514/27 [==============&gt;...............] - ETA: 2s - loss: 0.748415/27 [===============&gt;..............] - ETA: 2s - loss: 0.747016/27 [================&gt;.............] - ETA: 2s - loss: 0.749617/27 [=================&gt;............] - ETA: 1s - loss: 0.751718/27 [===================&gt;..........] - ETA: 1s - loss: 0.752019/27 [====================&gt;.........] - ETA: 1s - loss: 0.751820/27 [=====================&gt;........] - ETA: 1s - loss: 0.751821/27 [======================&gt;.......] - ETA: 1s - loss: 0.751522/27 [=======================&gt;......] - ETA: 0s - loss: 0.753223/27 [========================&gt;.....] - ETA: 0s - loss: 0.752624/27 [=========================&gt;....] - ETA: 0s - loss: 0.756125/27 [==========================&gt;...] - ETA: 0s - loss: 0.756326/27 [===========================&gt;..] - ETA: 0s - loss: 0.756627/27 [==============================] - ETA: 0s - loss: 0.757027/27 [==============================] - 5s 199ms/step - loss: 0.7570 - val_loss: 0.7416
Epoch 24/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.7193 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7489 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7534 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7464 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7514 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7521 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7567 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7473 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.750810/27 [==========&gt;...................] - ETA: 3s - loss: 0.753011/27 [===========&gt;..................] - ETA: 3s - loss: 0.745212/27 [============&gt;.................] - ETA: 2s - loss: 0.742413/27 [=============&gt;................] - ETA: 2s - loss: 0.750914/27 [==============&gt;...............] - ETA: 2s - loss: 0.767115/27 [===============&gt;..............] - ETA: 2s - loss: 0.772416/27 [================&gt;.............] - ETA: 2s - loss: 0.779917/27 [=================&gt;............] - ETA: 1s - loss: 0.788518/27 [===================&gt;..........] - ETA: 1s - loss: 0.794819/27 [====================&gt;.........] - ETA: 1s - loss: 0.798220/27 [=====================&gt;........] - ETA: 1s - loss: 0.803021/27 [======================&gt;.......] - ETA: 1s - loss: 0.807722/27 [=======================&gt;......] - ETA: 0s - loss: 0.812523/27 [========================&gt;.....] - ETA: 0s - loss: 0.815824/27 [=========================&gt;....] - ETA: 0s - loss: 0.817125/27 [==========================&gt;...] - ETA: 0s - loss: 0.818426/27 [===========================&gt;..] - ETA: 0s - loss: 0.820027/27 [==============================] - ETA: 0s - loss: 0.819227/27 [==============================] - 5s 199ms/step - loss: 0.8192 - val_loss: 0.8476
Epoch 25/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.8255 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8410 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8381 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8271 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8319 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8272 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8200 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8127 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.814010/27 [==========&gt;...................] - ETA: 3s - loss: 0.809011/27 [===========&gt;..................] - ETA: 3s - loss: 0.807512/27 [============&gt;.................] - ETA: 2s - loss: 0.807413/27 [=============&gt;................] - ETA: 2s - loss: 0.804514/27 [==============&gt;...............] - ETA: 2s - loss: 0.807015/27 [===============&gt;..............] - ETA: 2s - loss: 0.805416/27 [================&gt;.............] - ETA: 2s - loss: 0.803517/27 [=================&gt;............] - ETA: 1s - loss: 0.802918/27 [===================&gt;..........] - ETA: 1s - loss: 0.800319/27 [====================&gt;.........] - ETA: 1s - loss: 0.800520/27 [=====================&gt;........] - ETA: 1s - loss: 0.797321/27 [======================&gt;.......] - ETA: 1s - loss: 0.795622/27 [=======================&gt;......] - ETA: 0s - loss: 0.795323/27 [========================&gt;.....] - ETA: 0s - loss: 0.795424/27 [=========================&gt;....] - ETA: 0s - loss: 0.794525/27 [==========================&gt;...] - ETA: 0s - loss: 0.794226/27 [===========================&gt;..] - ETA: 0s - loss: 0.793227/27 [==============================] - ETA: 0s - loss: 0.792627/27 [==============================] - 5s 195ms/step - loss: 0.7926 - val_loss: 0.7723
Epoch 26/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.7759 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7791 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7793 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7668 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7652 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7673 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7679 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7675 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.766110/27 [==========&gt;...................] - ETA: 3s - loss: 0.764611/27 [===========&gt;..................] - ETA: 3s - loss: 0.768412/27 [============&gt;.................] - ETA: 2s - loss: 0.763413/27 [=============&gt;................] - ETA: 2s - loss: 0.760414/27 [==============&gt;...............] - ETA: 2s - loss: 0.762315/27 [===============&gt;..............] - ETA: 2s - loss: 0.763016/27 [================&gt;.............] - ETA: 2s - loss: 0.763217/27 [=================&gt;............] - ETA: 1s - loss: 0.761718/27 [===================&gt;..........] - ETA: 1s - loss: 0.762019/27 [====================&gt;.........] - ETA: 1s - loss: 0.759620/27 [=====================&gt;........] - ETA: 1s - loss: 0.758821/27 [======================&gt;.......] - ETA: 1s - loss: 0.757822/27 [=======================&gt;......] - ETA: 0s - loss: 0.758723/27 [========================&gt;.....] - ETA: 0s - loss: 0.757324/27 [=========================&gt;....] - ETA: 0s - loss: 0.757625/27 [==========================&gt;...] - ETA: 0s - loss: 0.756726/27 [===========================&gt;..] - ETA: 0s - loss: 0.755727/27 [==============================] - ETA: 0s - loss: 0.756127/27 [==============================] - 5s 200ms/step - loss: 0.7561 - val_loss: 0.7591
Epoch 27/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.7724 2/27 [=&gt;............................] - ETA: 5s - loss: 0.7485 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7532 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7549 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7479 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7459 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7489 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7479 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.739910/27 [==========&gt;...................] - ETA: 3s - loss: 0.742711/27 [===========&gt;..................] - ETA: 3s - loss: 0.743812/27 [============&gt;.................] - ETA: 2s - loss: 0.744213/27 [=============&gt;................] - ETA: 2s - loss: 0.746014/27 [==============&gt;...............] - ETA: 2s - loss: 0.741715/27 [===============&gt;..............] - ETA: 2s - loss: 0.738216/27 [================&gt;.............] - ETA: 2s - loss: 0.733617/27 [=================&gt;............] - ETA: 1s - loss: 0.733518/27 [===================&gt;..........] - ETA: 1s - loss: 0.734319/27 [====================&gt;.........] - ETA: 1s - loss: 0.733520/27 [=====================&gt;........] - ETA: 1s - loss: 0.733021/27 [======================&gt;.......] - ETA: 1s - loss: 0.733322/27 [=======================&gt;......] - ETA: 0s - loss: 0.732523/27 [========================&gt;.....] - ETA: 0s - loss: 0.736624/27 [=========================&gt;....] - ETA: 0s - loss: 0.737325/27 [==========================&gt;...] - ETA: 0s - loss: 0.739126/27 [===========================&gt;..] - ETA: 0s - loss: 0.740827/27 [==============================] - ETA: 0s - loss: 0.740227/27 [==============================] - 5s 200ms/step - loss: 0.7402 - val_loss: 0.7878
Epoch 28/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7611 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7790 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7735 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7833 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7811 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7764 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7762 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7744 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.777810/27 [==========&gt;...................] - ETA: 3s - loss: 0.777611/27 [===========&gt;..................] - ETA: 3s - loss: 0.777712/27 [============&gt;.................] - ETA: 2s - loss: 0.777413/27 [=============&gt;................] - ETA: 2s - loss: 0.778814/27 [==============&gt;...............] - ETA: 2s - loss: 0.775515/27 [===============&gt;..............] - ETA: 2s - loss: 0.772416/27 [================&gt;.............] - ETA: 2s - loss: 0.773717/27 [=================&gt;............] - ETA: 1s - loss: 0.772618/27 [===================&gt;..........] - ETA: 1s - loss: 0.772519/27 [====================&gt;.........] - ETA: 1s - loss: 0.773420/27 [=====================&gt;........] - ETA: 1s - loss: 0.772121/27 [======================&gt;.......] - ETA: 1s - loss: 0.771422/27 [=======================&gt;......] - ETA: 0s - loss: 0.768723/27 [========================&gt;.....] - ETA: 0s - loss: 0.769024/27 [=========================&gt;....] - ETA: 0s - loss: 0.768425/27 [==========================&gt;...] - ETA: 0s - loss: 0.768226/27 [===========================&gt;..] - ETA: 0s - loss: 0.766227/27 [==============================] - ETA: 0s - loss: 0.766227/27 [==============================] - 5s 203ms/step - loss: 0.7662 - val_loss: 0.7402
Epoch 29/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7502 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7545 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7328 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7334 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7338 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7345 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7366 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7384 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.737210/27 [==========&gt;...................] - ETA: 3s - loss: 0.737511/27 [===========&gt;..................] - ETA: 3s - loss: 0.737112/27 [============&gt;.................] - ETA: 2s - loss: 0.739313/27 [=============&gt;................] - ETA: 2s - loss: 0.742114/27 [==============&gt;...............] - ETA: 2s - loss: 0.742915/27 [===============&gt;..............] - ETA: 2s - loss: 0.743316/27 [================&gt;.............] - ETA: 2s - loss: 0.745417/27 [=================&gt;............] - ETA: 1s - loss: 0.744818/27 [===================&gt;..........] - ETA: 1s - loss: 0.746019/27 [====================&gt;.........] - ETA: 1s - loss: 0.746320/27 [=====================&gt;........] - ETA: 1s - loss: 0.746221/27 [======================&gt;.......] - ETA: 1s - loss: 0.744922/27 [=======================&gt;......] - ETA: 0s - loss: 0.742823/27 [========================&gt;.....] - ETA: 0s - loss: 0.740824/27 [=========================&gt;....] - ETA: 0s - loss: 0.739625/27 [==========================&gt;...] - ETA: 0s - loss: 0.738526/27 [===========================&gt;..] - ETA: 0s - loss: 0.737527/27 [==============================] - ETA: 0s - loss: 0.737127/27 [==============================] - 6s 206ms/step - loss: 0.7371 - val_loss: 0.6963
Epoch 30/200
 1/27 [&gt;.............................] - ETA: 6s - loss: 0.7500 2/27 [=&gt;............................] - ETA: 5s - loss: 0.7265 3/27 [==&gt;...........................] - ETA: 5s - loss: 0.7045 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7072 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7086 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7007 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.7040 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7172 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.720010/27 [==========&gt;...................] - ETA: 3s - loss: 0.714611/27 [===========&gt;..................] - ETA: 3s - loss: 0.713512/27 [============&gt;.................] - ETA: 2s - loss: 0.714913/27 [=============&gt;................] - ETA: 2s - loss: 0.718914/27 [==============&gt;...............] - ETA: 2s - loss: 0.720615/27 [===============&gt;..............] - ETA: 2s - loss: 0.723416/27 [================&gt;.............] - ETA: 2s - loss: 0.727617/27 [=================&gt;............] - ETA: 1s - loss: 0.726318/27 [===================&gt;..........] - ETA: 1s - loss: 0.728919/27 [====================&gt;.........] - ETA: 1s - loss: 0.732620/27 [=====================&gt;........] - ETA: 1s - loss: 0.729621/27 [======================&gt;.......] - ETA: 1s - loss: 0.729922/27 [=======================&gt;......] - ETA: 0s - loss: 0.728223/27 [========================&gt;.....] - ETA: 0s - loss: 0.726424/27 [=========================&gt;....] - ETA: 0s - loss: 0.727425/27 [==========================&gt;...] - ETA: 0s - loss: 0.725026/27 [===========================&gt;..] - ETA: 0s - loss: 0.723627/27 [==============================] - ETA: 0s - loss: 0.723827/27 [==============================] - 6s 205ms/step - loss: 0.7238 - val_loss: 0.6583
Epoch 31/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7122 2/27 [=&gt;............................] - ETA: 5s - loss: 0.7319 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7002 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7173 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7161 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7081 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.7198 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7190 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.719210/27 [==========&gt;...................] - ETA: 3s - loss: 0.724411/27 [===========&gt;..................] - ETA: 3s - loss: 0.725312/27 [============&gt;.................] - ETA: 2s - loss: 0.728913/27 [=============&gt;................] - ETA: 2s - loss: 0.731814/27 [==============&gt;...............] - ETA: 2s - loss: 0.733815/27 [===============&gt;..............] - ETA: 2s - loss: 0.731016/27 [================&gt;.............] - ETA: 2s - loss: 0.731117/27 [=================&gt;............] - ETA: 1s - loss: 0.728318/27 [===================&gt;..........] - ETA: 1s - loss: 0.724519/27 [====================&gt;.........] - ETA: 1s - loss: 0.732420/27 [=====================&gt;........] - ETA: 1s - loss: 0.735821/27 [======================&gt;.......] - ETA: 1s - loss: 0.740522/27 [=======================&gt;......] - ETA: 0s - loss: 0.744723/27 [========================&gt;.....] - ETA: 0s - loss: 0.748324/27 [=========================&gt;....] - ETA: 0s - loss: 0.752925/27 [==========================&gt;...] - ETA: 0s - loss: 0.753626/27 [===========================&gt;..] - ETA: 0s - loss: 0.755927/27 [==============================] - ETA: 0s - loss: 0.757227/27 [==============================] - 6s 204ms/step - loss: 0.7572 - val_loss: 0.8341
Epoch 32/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8189 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8082 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8200 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8180 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8197 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8138 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.8125 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8095 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.807710/27 [==========&gt;...................] - ETA: 3s - loss: 0.807111/27 [===========&gt;..................] - ETA: 3s - loss: 0.803212/27 [============&gt;.................] - ETA: 2s - loss: 0.805213/27 [=============&gt;................] - ETA: 2s - loss: 0.804114/27 [==============&gt;...............] - ETA: 2s - loss: 0.803915/27 [===============&gt;..............] - ETA: 2s - loss: 0.804916/27 [================&gt;.............] - ETA: 2s - loss: 0.803917/27 [=================&gt;............] - ETA: 1s - loss: 0.803918/27 [===================&gt;..........] - ETA: 1s - loss: 0.804419/27 [====================&gt;.........] - ETA: 1s - loss: 0.804820/27 [=====================&gt;........] - ETA: 1s - loss: 0.805821/27 [======================&gt;.......] - ETA: 1s - loss: 0.805822/27 [=======================&gt;......] - ETA: 0s - loss: 0.804123/27 [========================&gt;.....] - ETA: 0s - loss: 0.804024/27 [=========================&gt;....] - ETA: 0s - loss: 0.804225/27 [==========================&gt;...] - ETA: 0s - loss: 0.803726/27 [===========================&gt;..] - ETA: 0s - loss: 0.803127/27 [==============================] - ETA: 0s - loss: 0.803927/27 [==============================] - 5s 201ms/step - loss: 0.8039 - val_loss: 0.8297
Epoch 33/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8056 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8278 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8240 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8095 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8038 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8044 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7993 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7958 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.794110/27 [==========&gt;...................] - ETA: 3s - loss: 0.793911/27 [===========&gt;..................] - ETA: 3s - loss: 0.788912/27 [============&gt;.................] - ETA: 2s - loss: 0.790113/27 [=============&gt;................] - ETA: 2s - loss: 0.788514/27 [==============&gt;...............] - ETA: 2s - loss: 0.789015/27 [===============&gt;..............] - ETA: 2s - loss: 0.787816/27 [================&gt;.............] - ETA: 2s - loss: 0.786717/27 [=================&gt;............] - ETA: 1s - loss: 0.786118/27 [===================&gt;..........] - ETA: 1s - loss: 0.787119/27 [====================&gt;.........] - ETA: 1s - loss: 0.784720/27 [=====================&gt;........] - ETA: 1s - loss: 0.783321/27 [======================&gt;.......] - ETA: 1s - loss: 0.783522/27 [=======================&gt;......] - ETA: 0s - loss: 0.781623/27 [========================&gt;.....] - ETA: 0s - loss: 0.780224/27 [=========================&gt;....] - ETA: 0s - loss: 0.779725/27 [==========================&gt;...] - ETA: 0s - loss: 0.779026/27 [===========================&gt;..] - ETA: 0s - loss: 0.777327/27 [==============================] - ETA: 0s - loss: 0.778727/27 [==============================] - 5s 201ms/step - loss: 0.7787 - val_loss: 0.7695
Epoch 34/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7687 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7821 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7716 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7653 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7584 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7610 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7657 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7644 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.769810/27 [==========&gt;...................] - ETA: 3s - loss: 0.765411/27 [===========&gt;..................] - ETA: 3s - loss: 0.764712/27 [============&gt;.................] - ETA: 2s - loss: 0.762113/27 [=============&gt;................] - ETA: 2s - loss: 0.762514/27 [==============&gt;...............] - ETA: 2s - loss: 0.764315/27 [===============&gt;..............] - ETA: 2s - loss: 0.763416/27 [================&gt;.............] - ETA: 2s - loss: 0.760417/27 [=================&gt;............] - ETA: 1s - loss: 0.755418/27 [===================&gt;..........] - ETA: 1s - loss: 0.753219/27 [====================&gt;.........] - ETA: 1s - loss: 0.753720/27 [=====================&gt;........] - ETA: 1s - loss: 0.749921/27 [======================&gt;.......] - ETA: 1s - loss: 0.754422/27 [=======================&gt;......] - ETA: 0s - loss: 0.756523/27 [========================&gt;.....] - ETA: 0s - loss: 0.757024/27 [=========================&gt;....] - ETA: 0s - loss: 0.758925/27 [==========================&gt;...] - ETA: 0s - loss: 0.761126/27 [===========================&gt;..] - ETA: 0s - loss: 0.760327/27 [==============================] - ETA: 0s - loss: 0.760527/27 [==============================] - 5s 200ms/step - loss: 0.7605 - val_loss: 0.7881
Epoch 35/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8011 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7952 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7867 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7737 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7708 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7682 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7717 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7667 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.765310/27 [==========&gt;...................] - ETA: 3s - loss: 0.760511/27 [===========&gt;..................] - ETA: 3s - loss: 0.758512/27 [============&gt;.................] - ETA: 2s - loss: 0.756913/27 [=============&gt;................] - ETA: 2s - loss: 0.753214/27 [==============&gt;...............] - ETA: 2s - loss: 0.750415/27 [===============&gt;..............] - ETA: 2s - loss: 0.745316/27 [================&gt;.............] - ETA: 2s - loss: 0.743117/27 [=================&gt;............] - ETA: 1s - loss: 0.739918/27 [===================&gt;..........] - ETA: 1s - loss: 0.737619/27 [====================&gt;.........] - ETA: 1s - loss: 0.731120/27 [=====================&gt;........] - ETA: 1s - loss: 0.729521/27 [======================&gt;.......] - ETA: 1s - loss: 0.725622/27 [=======================&gt;......] - ETA: 0s - loss: 0.723623/27 [========================&gt;.....] - ETA: 0s - loss: 0.723724/27 [=========================&gt;....] - ETA: 0s - loss: 0.722825/27 [==========================&gt;...] - ETA: 0s - loss: 0.719826/27 [===========================&gt;..] - ETA: 0s - loss: 0.717227/27 [==============================] - ETA: 0s - loss: 0.716727/27 [==============================] - 5s 203ms/step - loss: 0.7167 - val_loss: 0.6576
Epoch 36/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.6856 2/27 [=&gt;............................] - ETA: 4s - loss: 0.6463 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.6614 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.6713 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.6598 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.6645 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7135 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7396 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.759010/27 [==========&gt;...................] - ETA: 3s - loss: 0.774611/27 [===========&gt;..................] - ETA: 3s - loss: 0.785212/27 [============&gt;.................] - ETA: 2s - loss: 0.788213/27 [=============&gt;................] - ETA: 2s - loss: 0.791314/27 [==============&gt;...............] - ETA: 2s - loss: 0.789515/27 [===============&gt;..............] - ETA: 2s - loss: 0.791016/27 [================&gt;.............] - ETA: 2s - loss: 0.797117/27 [=================&gt;............] - ETA: 1s - loss: 0.797018/27 [===================&gt;..........] - ETA: 1s - loss: 0.795119/27 [====================&gt;.........] - ETA: 1s - loss: 0.794120/27 [=====================&gt;........] - ETA: 1s - loss: 0.794521/27 [======================&gt;.......] - ETA: 1s - loss: 0.793622/27 [=======================&gt;......] - ETA: 0s - loss: 0.792823/27 [========================&gt;.....] - ETA: 0s - loss: 0.793624/27 [=========================&gt;....] - ETA: 0s - loss: 0.792325/27 [==========================&gt;...] - ETA: 0s - loss: 0.790926/27 [===========================&gt;..] - ETA: 0s - loss: 0.788127/27 [==============================] - ETA: 0s - loss: 0.788027/27 [==============================] - 6s 206ms/step - loss: 0.7880 - val_loss: 0.7973
Epoch 37/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7505 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7441 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7292 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7295 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7366 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7410 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7423 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7465 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.746310/27 [==========&gt;...................] - ETA: 3s - loss: 0.747111/27 [===========&gt;..................] - ETA: 3s - loss: 0.746212/27 [============&gt;.................] - ETA: 3s - loss: 0.746513/27 [=============&gt;................] - ETA: 2s - loss: 0.746714/27 [==============&gt;...............] - ETA: 2s - loss: 0.745615/27 [===============&gt;..............] - ETA: 2s - loss: 0.744516/27 [================&gt;.............] - ETA: 2s - loss: 0.743517/27 [=================&gt;............] - ETA: 1s - loss: 0.744218/27 [===================&gt;..........] - ETA: 1s - loss: 0.746419/27 [====================&gt;.........] - ETA: 1s - loss: 0.746920/27 [=====================&gt;........] - ETA: 1s - loss: 0.746821/27 [======================&gt;.......] - ETA: 1s - loss: 0.747922/27 [=======================&gt;......] - ETA: 0s - loss: 0.748523/27 [========================&gt;.....] - ETA: 0s - loss: 0.747924/27 [=========================&gt;....] - ETA: 0s - loss: 0.747825/27 [==========================&gt;...] - ETA: 0s - loss: 0.744426/27 [===========================&gt;..] - ETA: 0s - loss: 0.743927/27 [==============================] - ETA: 0s - loss: 0.743627/27 [==============================] - 6s 206ms/step - loss: 0.7436 - val_loss: 0.7180
Epoch 38/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7219 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7046 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7079 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7222 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7180 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7078 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7054 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7031 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.704110/27 [==========&gt;...................] - ETA: 3s - loss: 0.695411/27 [===========&gt;..................] - ETA: 3s - loss: 0.693512/27 [============&gt;.................] - ETA: 2s - loss: 0.691913/27 [=============&gt;................] - ETA: 2s - loss: 0.693014/27 [==============&gt;...............] - ETA: 2s - loss: 0.693815/27 [===============&gt;..............] - ETA: 2s - loss: 0.700416/27 [================&gt;.............] - ETA: 2s - loss: 0.700817/27 [=================&gt;............] - ETA: 1s - loss: 0.700718/27 [===================&gt;..........] - ETA: 1s - loss: 0.704619/27 [====================&gt;.........] - ETA: 1s - loss: 0.707520/27 [=====================&gt;........] - ETA: 1s - loss: 0.706821/27 [======================&gt;.......] - ETA: 1s - loss: 0.708422/27 [=======================&gt;......] - ETA: 0s - loss: 0.709523/27 [========================&gt;.....] - ETA: 0s - loss: 0.711924/27 [=========================&gt;....] - ETA: 0s - loss: 0.710325/27 [==========================&gt;...] - ETA: 0s - loss: 0.711926/27 [===========================&gt;..] - ETA: 0s - loss: 0.712827/27 [==============================] - ETA: 0s - loss: 0.713027/27 [==============================] - 5s 203ms/step - loss: 0.7130 - val_loss: 0.7743
Epoch 39/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7606 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7798 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7526 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7495 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7392 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7415 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.7412 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7324 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.731810/27 [==========&gt;...................] - ETA: 3s - loss: 0.730411/27 [===========&gt;..................] - ETA: 3s - loss: 0.727912/27 [============&gt;.................] - ETA: 2s - loss: 0.722813/27 [=============&gt;................] - ETA: 2s - loss: 0.716114/27 [==============&gt;...............] - ETA: 2s - loss: 0.713015/27 [===============&gt;..............] - ETA: 2s - loss: 0.710316/27 [================&gt;.............] - ETA: 2s - loss: 0.707617/27 [=================&gt;............] - ETA: 1s - loss: 0.705518/27 [===================&gt;..........] - ETA: 1s - loss: 0.701219/27 [====================&gt;.........] - ETA: 1s - loss: 0.696620/27 [=====================&gt;........] - ETA: 1s - loss: 0.692721/27 [======================&gt;.......] - ETA: 1s - loss: 0.690822/27 [=======================&gt;......] - ETA: 0s - loss: 0.688223/27 [========================&gt;.....] - ETA: 0s - loss: 0.688924/27 [=========================&gt;....] - ETA: 0s - loss: 0.684825/27 [==========================&gt;...] - ETA: 0s - loss: 0.680526/27 [===========================&gt;..] - ETA: 0s - loss: 0.686927/27 [==============================] - ETA: 0s - loss: 0.688927/27 [==============================] - 6s 205ms/step - loss: 0.6889 - val_loss: 0.8731
Epoch 40/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8830 2/27 [=&gt;............................] - ETA: 4s - loss: 0.8092 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7884 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7869 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7821 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7685 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.7736 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7732 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.771510/27 [==========&gt;...................] - ETA: 3s - loss: 0.771511/27 [===========&gt;..................] - ETA: 3s - loss: 0.770612/27 [============&gt;.................] - ETA: 2s - loss: 0.768413/27 [=============&gt;................] - ETA: 2s - loss: 0.764214/27 [==============&gt;...............] - ETA: 2s - loss: 0.759715/27 [===============&gt;..............] - ETA: 2s - loss: 0.756516/27 [================&gt;.............] - ETA: 2s - loss: 0.750717/27 [=================&gt;............] - ETA: 1s - loss: 0.746618/27 [===================&gt;..........] - ETA: 1s - loss: 0.743519/27 [====================&gt;.........] - ETA: 1s - loss: 0.737420/27 [=====================&gt;........] - ETA: 1s - loss: 0.732921/27 [======================&gt;.......] - ETA: 1s - loss: 0.728622/27 [=======================&gt;......] - ETA: 0s - loss: 0.725423/27 [========================&gt;.....] - ETA: 0s - loss: 0.723424/27 [=========================&gt;....] - ETA: 0s - loss: 0.719625/27 [==========================&gt;...] - ETA: 0s - loss: 0.717926/27 [===========================&gt;..] - ETA: 0s - loss: 0.715527/27 [==============================] - ETA: 0s - loss: 0.713927/27 [==============================] - 6s 204ms/step - loss: 0.7139 - val_loss: 0.6958
Epoch 41/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7066 2/27 [=&gt;............................] - ETA: 4s - loss: 0.6869 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.6681 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.6811 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.6755 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.6678 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.6600 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.6619 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.676710/27 [==========&gt;...................] - ETA: 3s - loss: 0.689311/27 [===========&gt;..................] - ETA: 3s - loss: 0.689712/27 [============&gt;.................] - ETA: 2s - loss: 0.696713/27 [=============&gt;................] - ETA: 2s - loss: 0.695114/27 [==============&gt;...............] - ETA: 2s - loss: 0.694215/27 [===============&gt;..............] - ETA: 2s - loss: 0.696916/27 [================&gt;.............] - ETA: 2s - loss: 0.694117/27 [=================&gt;............] - ETA: 1s - loss: 0.695018/27 [===================&gt;..........] - ETA: 1s - loss: 0.694919/27 [====================&gt;.........] - ETA: 1s - loss: 0.694220/27 [=====================&gt;........] - ETA: 1s - loss: 0.688921/27 [======================&gt;.......] - ETA: 1s - loss: 0.693322/27 [=======================&gt;......] - ETA: 0s - loss: 0.693123/27 [========================&gt;.....] - ETA: 0s - loss: 0.690024/27 [=========================&gt;....] - ETA: 0s - loss: 0.688925/27 [==========================&gt;...] - ETA: 0s - loss: 0.688926/27 [===========================&gt;..] - ETA: 0s - loss: 0.684927/27 [==============================] - ETA: 0s - loss: 0.685027/27 [==============================] - 5s 203ms/step - loss: 0.6850 - val_loss: 0.6244
Epoch 42/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.5817 2/27 [=&gt;............................] - ETA: 4s - loss: 0.6019 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.6015 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.6090 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.6046 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.6053 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.6053 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.6085 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.630910/27 [==========&gt;...................] - ETA: 3s - loss: 0.644811/27 [===========&gt;..................] - ETA: 3s - loss: 0.640812/27 [============&gt;.................] - ETA: 2s - loss: 0.661213/27 [=============&gt;................] - ETA: 2s - loss: 0.660914/27 [==============&gt;...............] - ETA: 2s - loss: 0.660115/27 [===============&gt;..............] - ETA: 2s - loss: 0.665316/27 [================&gt;.............] - ETA: 2s - loss: 0.670017/27 [=================&gt;............] - ETA: 1s - loss: 0.670618/27 [===================&gt;..........] - ETA: 1s - loss: 0.671119/27 [====================&gt;.........] - ETA: 1s - loss: 0.673220/27 [=====================&gt;........] - ETA: 1s - loss: 0.674921/27 [======================&gt;.......] - ETA: 1s - loss: 0.676122/27 [=======================&gt;......] - ETA: 0s - loss: 0.678523/27 [========================&gt;.....] - ETA: 0s - loss: 0.678124/27 [=========================&gt;....] - ETA: 0s - loss: 0.677125/27 [==========================&gt;...] - ETA: 0s - loss: 0.677926/27 [===========================&gt;..] - ETA: 0s - loss: 0.679227/27 [==============================] - ETA: 0s - loss: 0.680127/27 [==============================] - 5s 204ms/step - loss: 0.6801 - val_loss: 0.6405
Epoch 43/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.6424 2/27 [=&gt;............................] - ETA: 5s - loss: 0.6492 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.6466 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.6319 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.6338 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.6407 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.6327 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.6264 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.625810/27 [==========&gt;...................] - ETA: 3s - loss: 0.624411/27 [===========&gt;..................] - ETA: 3s - loss: 0.626212/27 [============&gt;.................] - ETA: 2s - loss: 0.623113/27 [=============&gt;................] - ETA: 2s - loss: 0.622214/27 [==============&gt;...............] - ETA: 2s - loss: 0.619015/27 [===============&gt;..............] - ETA: 2s - loss: 0.617616/27 [================&gt;.............] - ETA: 2s - loss: 0.623017/27 [=================&gt;............] - ETA: 1s - loss: 0.624718/27 [===================&gt;..........] - ETA: 1s - loss: 0.623519/27 [====================&gt;.........] - ETA: 1s - loss: 0.630520/27 [=====================&gt;........] - ETA: 1s - loss: 0.628921/27 [======================&gt;.......] - ETA: 1s - loss: 0.630122/27 [=======================&gt;......] - ETA: 0s - loss: 0.626923/27 [========================&gt;.....] - ETA: 0s - loss: 0.628224/27 [=========================&gt;....] - ETA: 0s - loss: 0.627625/27 [==========================&gt;...] - ETA: 0s - loss: 0.627926/27 [===========================&gt;..] - ETA: 0s - loss: 0.625927/27 [==============================] - ETA: 0s - loss: 0.626627/27 [==============================] - 5s 202ms/step - loss: 0.6266 - val_loss: 0.5557
Epoch 44/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5808 2/27 [=&gt;............................] - ETA: 4s - loss: 0.5772 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5956 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5863 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5901 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5896 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5947 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5927 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.594410/27 [==========&gt;...................] - ETA: 3s - loss: 0.590011/27 [===========&gt;..................] - ETA: 3s - loss: 0.587112/27 [============&gt;.................] - ETA: 2s - loss: 0.581113/27 [=============&gt;................] - ETA: 2s - loss: 0.578214/27 [==============&gt;...............] - ETA: 2s - loss: 0.575715/27 [===============&gt;..............] - ETA: 2s - loss: 0.575316/27 [================&gt;.............] - ETA: 2s - loss: 0.570217/27 [=================&gt;............] - ETA: 1s - loss: 0.567018/27 [===================&gt;..........] - ETA: 1s - loss: 0.561519/27 [====================&gt;.........] - ETA: 1s - loss: 0.558620/27 [=====================&gt;........] - ETA: 1s - loss: 0.555121/27 [======================&gt;.......] - ETA: 1s - loss: 0.552722/27 [=======================&gt;......] - ETA: 0s - loss: 0.554323/27 [========================&gt;.....] - ETA: 0s - loss: 0.552824/27 [=========================&gt;....] - ETA: 0s - loss: 0.556425/27 [==========================&gt;...] - ETA: 0s - loss: 0.554326/27 [===========================&gt;..] - ETA: 0s - loss: 0.553627/27 [==============================] - ETA: 0s - loss: 0.552427/27 [==============================] - 5s 203ms/step - loss: 0.5524 - val_loss: 0.5770
Epoch 45/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.5802 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5548 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5777 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5627 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5575 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5630 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5596 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5668 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.566710/27 [==========&gt;...................] - ETA: 3s - loss: 0.562011/27 [===========&gt;..................] - ETA: 3s - loss: 0.561612/27 [============&gt;.................] - ETA: 2s - loss: 0.561613/27 [=============&gt;................] - ETA: 2s - loss: 0.559814/27 [==============&gt;...............] - ETA: 2s - loss: 0.558815/27 [===============&gt;..............] - ETA: 2s - loss: 0.558516/27 [================&gt;.............] - ETA: 2s - loss: 0.558917/27 [=================&gt;............] - ETA: 1s - loss: 0.558518/27 [===================&gt;..........] - ETA: 1s - loss: 0.557619/27 [====================&gt;.........] - ETA: 1s - loss: 0.555520/27 [=====================&gt;........] - ETA: 1s - loss: 0.552821/27 [======================&gt;.......] - ETA: 1s - loss: 0.552222/27 [=======================&gt;......] - ETA: 0s - loss: 0.549823/27 [========================&gt;.....] - ETA: 0s - loss: 0.547524/27 [=========================&gt;....] - ETA: 0s - loss: 0.547125/27 [==========================&gt;...] - ETA: 0s - loss: 0.547926/27 [===========================&gt;..] - ETA: 0s - loss: 0.547627/27 [==============================] - ETA: 0s - loss: 0.547827/27 [==============================] - 5s 204ms/step - loss: 0.5478 - val_loss: 0.4756
Epoch 46/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5227 2/27 [=&gt;............................] - ETA: 4s - loss: 0.5157 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5182 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5227 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5178 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5197 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5183 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5135 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.511410/27 [==========&gt;...................] - ETA: 3s - loss: 0.507411/27 [===========&gt;..................] - ETA: 3s - loss: 0.507312/27 [============&gt;.................] - ETA: 2s - loss: 0.509413/27 [=============&gt;................] - ETA: 2s - loss: 0.511614/27 [==============&gt;...............] - ETA: 2s - loss: 0.511215/27 [===============&gt;..............] - ETA: 2s - loss: 0.510616/27 [================&gt;.............] - ETA: 2s - loss: 0.508917/27 [=================&gt;............] - ETA: 1s - loss: 0.506418/27 [===================&gt;..........] - ETA: 1s - loss: 0.505519/27 [====================&gt;.........] - ETA: 1s - loss: 0.505220/27 [=====================&gt;........] - ETA: 1s - loss: 0.504321/27 [======================&gt;.......] - ETA: 1s - loss: 0.502922/27 [=======================&gt;......] - ETA: 0s - loss: 0.501823/27 [========================&gt;.....] - ETA: 0s - loss: 0.498324/27 [=========================&gt;....] - ETA: 0s - loss: 0.496825/27 [==========================&gt;...] - ETA: 0s - loss: 0.496726/27 [===========================&gt;..] - ETA: 0s - loss: 0.497527/27 [==============================] - ETA: 0s - loss: 0.498027/27 [==============================] - 6s 204ms/step - loss: 0.4980 - val_loss: 0.4664
Epoch 47/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5103 2/27 [=&gt;............................] - ETA: 4s - loss: 0.5112 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5073 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5060 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5012 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5028 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5023 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5053 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.500710/27 [==========&gt;...................] - ETA: 3s - loss: 0.499211/27 [===========&gt;..................] - ETA: 3s - loss: 0.504312/27 [============&gt;.................] - ETA: 2s - loss: 0.510113/27 [=============&gt;................] - ETA: 2s - loss: 0.511614/27 [==============&gt;...............] - ETA: 2s - loss: 0.507615/27 [===============&gt;..............] - ETA: 2s - loss: 0.510616/27 [================&gt;.............] - ETA: 2s - loss: 0.506917/27 [=================&gt;............] - ETA: 1s - loss: 0.505718/27 [===================&gt;..........] - ETA: 1s - loss: 0.501619/27 [====================&gt;.........] - ETA: 1s - loss: 0.501820/27 [=====================&gt;........] - ETA: 1s - loss: 0.500321/27 [======================&gt;.......] - ETA: 1s - loss: 0.500122/27 [=======================&gt;......] - ETA: 0s - loss: 0.500323/27 [========================&gt;.....] - ETA: 0s - loss: 0.496924/27 [=========================&gt;....] - ETA: 0s - loss: 0.500725/27 [==========================&gt;...] - ETA: 0s - loss: 0.498326/27 [===========================&gt;..] - ETA: 0s - loss: 0.496327/27 [==============================] - ETA: 0s - loss: 0.496227/27 [==============================] - 5s 204ms/step - loss: 0.4962 - val_loss: 0.4757
Epoch 48/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5367 2/27 [=&gt;............................] - ETA: 4s - loss: 0.5312 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5295 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5216 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5055 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.4971 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.4906 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.4870 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.488710/27 [==========&gt;...................] - ETA: 3s - loss: 0.492011/27 [===========&gt;..................] - ETA: 3s - loss: 0.490012/27 [============&gt;.................] - ETA: 2s - loss: 0.490213/27 [=============&gt;................] - ETA: 2s - loss: 0.487714/27 [==============&gt;...............] - ETA: 2s - loss: 0.484415/27 [===============&gt;..............] - ETA: 2s - loss: 0.486116/27 [================&gt;.............] - ETA: 2s - loss: 0.484417/27 [=================&gt;............] - ETA: 1s - loss: 0.488118/27 [===================&gt;..........] - ETA: 1s - loss: 0.485919/27 [====================&gt;.........] - ETA: 1s - loss: 0.485520/27 [=====================&gt;........] - ETA: 1s - loss: 0.483121/27 [======================&gt;.......] - ETA: 1s - loss: 0.484622/27 [=======================&gt;......] - ETA: 0s - loss: 0.484323/27 [========================&gt;.....] - ETA: 0s - loss: 0.483124/27 [=========================&gt;....] - ETA: 0s - loss: 0.482525/27 [==========================&gt;...] - ETA: 0s - loss: 0.480026/27 [===========================&gt;..] - ETA: 0s - loss: 0.478427/27 [==============================] - ETA: 0s - loss: 0.478827/27 [==============================] - 6s 205ms/step - loss: 0.4788 - val_loss: 0.4257
Epoch 49/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5106 2/27 [=&gt;............................] - ETA: 5s - loss: 0.4886 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.4805 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.4823 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.4916 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.4947 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.4912 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.4967 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.497010/27 [==========&gt;...................] - ETA: 3s - loss: 0.494611/27 [===========&gt;..................] - ETA: 3s - loss: 0.492212/27 [============&gt;.................] - ETA: 2s - loss: 0.496013/27 [=============&gt;................] - ETA: 2s - loss: 0.493214/27 [==============&gt;...............] - ETA: 2s - loss: 0.492815/27 [===============&gt;..............] - ETA: 2s - loss: 0.492716/27 [================&gt;.............] - ETA: 2s - loss: 0.493517/27 [=================&gt;............] - ETA: 1s - loss: 0.493518/27 [===================&gt;..........] - ETA: 1s - loss: 0.488719/27 [====================&gt;.........] - ETA: 1s - loss: 0.484720/27 [=====================&gt;........] - ETA: 1s - loss: 0.484021/27 [======================&gt;.......] - ETA: 1s - loss: 0.481422/27 [=======================&gt;......] - ETA: 0s - loss: 0.481423/27 [========================&gt;.....] - ETA: 0s - loss: 0.479124/27 [=========================&gt;....] - ETA: 0s - loss: 0.477225/27 [==========================&gt;...] - ETA: 0s - loss: 0.476626/27 [===========================&gt;..] - ETA: 0s - loss: 0.477627/27 [==============================] - ETA: 0s - loss: 0.476227/27 [==============================] - 6s 206ms/step - loss: 0.4762 - val_loss: 0.4173
Epoch 50/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.4743 2/27 [=&gt;............................] - ETA: 4s - loss: 0.4735 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.4805 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.4801 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.4980 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5145 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5150 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5108 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.507410/27 [==========&gt;...................] - ETA: 3s - loss: 0.506011/27 [===========&gt;..................] - ETA: 3s - loss: 0.500712/27 [============&gt;.................] - ETA: 2s - loss: 0.492813/27 [=============&gt;................] - ETA: 2s - loss: 0.490414/27 [==============&gt;...............] - ETA: 2s - loss: 0.491015/27 [===============&gt;..............] - ETA: 2s - loss: 0.492916/27 [================&gt;.............] - ETA: 2s - loss: 0.494917/27 [=================&gt;............] - ETA: 1s - loss: 0.495418/27 [===================&gt;..........] - ETA: 1s - loss: 0.495619/27 [====================&gt;.........] - ETA: 1s - loss: 0.497920/27 [=====================&gt;........] - ETA: 1s - loss: 0.506721/27 [======================&gt;.......] - ETA: 1s - loss: 0.515922/27 [=======================&gt;......] - ETA: 0s - loss: 0.529423/27 [========================&gt;.....] - ETA: 0s - loss: 0.537924/27 [=========================&gt;....] - ETA: 0s - loss: 0.542925/27 [==========================&gt;...] - ETA: 0s - loss: 0.547526/27 [===========================&gt;..] - ETA: 0s - loss: 0.551127/27 [==============================] - ETA: 0s - loss: 0.552927/27 [==============================] - 6s 206ms/step - loss: 0.5529 - val_loss: 1.1203
Epoch 51/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 1.1552 2/27 [=&gt;............................] - ETA: 4s - loss: 1.1480 3/27 [==&gt;...........................] - ETA: 4s - loss: 1.1760 4/27 [===&gt;..........................] - ETA: 4s - loss: 1.1758 5/27 [====&gt;.........................] - ETA: 4s - loss: 1.1791 6/27 [=====&gt;........................] - ETA: 4s - loss: 1.1846 7/27 [======&gt;.......................] - ETA: 3s - loss: 1.1750 8/27 [=======&gt;......................] - ETA: 3s - loss: 1.1617 9/27 [=========&gt;....................] - ETA: 3s - loss: 1.150210/27 [==========&gt;...................] - ETA: 3s - loss: 1.139211/27 [===========&gt;..................] - ETA: 3s - loss: 1.131212/27 [============&gt;.................] - ETA: 2s - loss: 1.125713/27 [=============&gt;................] - ETA: 2s - loss: 1.118014/27 [==============&gt;...............] - ETA: 2s - loss: 1.110615/27 [===============&gt;..............] - ETA: 2s - loss: 1.105216/27 [================&gt;.............] - ETA: 2s - loss: 1.098917/27 [=================&gt;............] - ETA: 1s - loss: 1.093118/27 [===================&gt;..........] - ETA: 1s - loss: 1.089319/27 [====================&gt;.........] - ETA: 1s - loss: 1.083920/27 [=====================&gt;........] - ETA: 1s - loss: 1.080421/27 [======================&gt;.......] - ETA: 1s - loss: 1.076922/27 [=======================&gt;......] - ETA: 0s - loss: 1.073823/27 [========================&gt;.....] - ETA: 0s - loss: 1.070024/27 [=========================&gt;....] - ETA: 0s - loss: 1.065725/27 [==========================&gt;...] - ETA: 0s - loss: 1.062326/27 [===========================&gt;..] - ETA: 0s - loss: 1.059527/27 [==============================] - ETA: 0s - loss: 1.058327/27 [==============================] - 6s 206ms/step - loss: 1.0583 - val_loss: 0.9754
Epoch 52/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.9587 2/27 [=&gt;............................] - ETA: 4s - loss: 0.9594 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.9607 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.9585 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.9581 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.9583 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.9556 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.9527 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.953110/27 [==========&gt;...................] - ETA: 3s - loss: 0.951611/27 [===========&gt;..................] - ETA: 3s - loss: 0.948012/27 [============&gt;.................] - ETA: 3s - loss: 0.948313/27 [=============&gt;................] - ETA: 2s - loss: 0.946114/27 [==============&gt;...............] - ETA: 2s - loss: 0.945415/27 [===============&gt;..............] - ETA: 2s - loss: 0.944516/27 [================&gt;.............] - ETA: 2s - loss: 0.944817/27 [=================&gt;............] - ETA: 2s - loss: 0.944218/27 [===================&gt;..........] - ETA: 1s - loss: 0.944519/27 [====================&gt;.........] - ETA: 1s - loss: 0.943520/27 [=====================&gt;........] - ETA: 1s - loss: 0.942821/27 [======================&gt;.......] - ETA: 1s - loss: 0.940622/27 [=======================&gt;......] - ETA: 1s - loss: 0.940123/27 [========================&gt;.....] - ETA: 0s - loss: 0.938624/27 [=========================&gt;....] - ETA: 0s - loss: 0.937925/27 [==========================&gt;...] - ETA: 0s - loss: 0.936826/27 [===========================&gt;..] - ETA: 0s - loss: 0.935727/27 [==============================] - ETA: 0s - loss: 0.935527/27 [==============================] - 6s 209ms/step - loss: 0.9355 - val_loss: 0.9300
Epoch 53/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.9124 2/27 [=&gt;............................] - ETA: 4s - loss: 0.9066 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.9027 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.9044 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.9024 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8994 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.9014 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.9028 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.900810/27 [==========&gt;...................] - ETA: 3s - loss: 0.899011/27 [===========&gt;..................] - ETA: 3s - loss: 0.899112/27 [============&gt;.................] - ETA: 3s - loss: 0.899813/27 [=============&gt;................] - ETA: 2s - loss: 0.900214/27 [==============&gt;...............] - ETA: 2s - loss: 0.899015/27 [===============&gt;..............] - ETA: 2s - loss: 0.898316/27 [================&gt;.............] - ETA: 2s - loss: 0.893717/27 [=================&gt;............] - ETA: 2s - loss: 0.897218/27 [===================&gt;..........] - ETA: 1s - loss: 0.896919/27 [====================&gt;.........] - ETA: 1s - loss: 0.895620/27 [=====================&gt;........] - ETA: 1s - loss: 0.892921/27 [======================&gt;.......] - ETA: 1s - loss: 0.893022/27 [=======================&gt;......] - ETA: 1s - loss: 0.894623/27 [========================&gt;.....] - ETA: 0s - loss: 0.894324/27 [=========================&gt;....] - ETA: 0s - loss: 0.894725/27 [==========================&gt;...] - ETA: 0s - loss: 0.894826/27 [===========================&gt;..] - ETA: 0s - loss: 0.892827/27 [==============================] - ETA: 0s - loss: 0.892127/27 [==============================] - 6s 211ms/step - loss: 0.8921 - val_loss: 0.9221
Epoch 54/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8533 2/27 [=&gt;............................] - ETA: 5s - loss: 0.8469 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8540 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8621 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8567 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8534 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.8511 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8531 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.847210/27 [==========&gt;...................] - ETA: 3s - loss: 0.849311/27 [===========&gt;..................] - ETA: 3s - loss: 0.847512/27 [============&gt;.................] - ETA: 3s - loss: 0.852713/27 [=============&gt;................] - ETA: 2s - loss: 0.858114/27 [==============&gt;...............] - ETA: 2s - loss: 0.857215/27 [===============&gt;..............] - ETA: 2s - loss: 0.858916/27 [================&gt;.............] - ETA: 2s - loss: 0.863617/27 [=================&gt;............] - ETA: 2s - loss: 0.867418/27 [===================&gt;..........] - ETA: 1s - loss: 0.870819/27 [====================&gt;.........] - ETA: 1s - loss: 0.870220/27 [=====================&gt;........] - ETA: 1s - loss: 0.868121/27 [======================&gt;.......] - ETA: 1s - loss: 0.868822/27 [=======================&gt;......] - ETA: 1s - loss: 0.869623/27 [========================&gt;.....] - ETA: 0s - loss: 0.869624/27 [=========================&gt;....] - ETA: 0s - loss: 0.869225/27 [==========================&gt;...] - ETA: 0s - loss: 0.868226/27 [===========================&gt;..] - ETA: 0s - loss: 0.866727/27 [==============================] - ETA: 0s - loss: 0.866927/27 [==============================] - 6s 222ms/step - loss: 0.8669 - val_loss: 0.8831
Epoch 55/200
 1/27 [&gt;.............................] - ETA: 6s - loss: 0.8538 2/27 [=&gt;............................] - ETA: 6s - loss: 0.8328 3/27 [==&gt;...........................] - ETA: 5s - loss: 0.8227 4/27 [===&gt;..........................] - ETA: 5s - loss: 0.8158 5/27 [====&gt;.........................] - ETA: 5s - loss: 0.7960 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8068 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.8040 8/27 [=======&gt;......................] - ETA: 4s - loss: 0.8138 9/27 [=========&gt;....................] - ETA: 4s - loss: 0.808910/27 [==========&gt;...................] - ETA: 3s - loss: 0.810311/27 [===========&gt;..................] - ETA: 3s - loss: 0.803212/27 [============&gt;.................] - ETA: 3s - loss: 0.799613/27 [=============&gt;................] - ETA: 3s - loss: 0.793114/27 [==============&gt;...............] - ETA: 2s - loss: 0.798115/27 [===============&gt;..............] - ETA: 2s - loss: 0.797716/27 [================&gt;.............] - ETA: 2s - loss: 0.797717/27 [=================&gt;............] - ETA: 2s - loss: 0.802718/27 [===================&gt;..........] - ETA: 2s - loss: 0.806019/27 [====================&gt;.........] - ETA: 1s - loss: 0.805620/27 [=====================&gt;........] - ETA: 1s - loss: 0.805221/27 [======================&gt;.......] - ETA: 1s - loss: 0.805622/27 [=======================&gt;......] - ETA: 1s - loss: 0.802223/27 [========================&gt;.....] - ETA: 0s - loss: 0.797424/27 [=========================&gt;....] - ETA: 0s - loss: 0.793325/27 [==========================&gt;...] - ETA: 0s - loss: 0.797426/27 [===========================&gt;..] - ETA: 0s - loss: 0.802127/27 [==============================] - ETA: 0s - loss: 0.803427/27 [==============================] - 6s 234ms/step - loss: 0.8034 - val_loss: 0.8378
Epoch 56/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.8037 2/27 [=&gt;............................] - ETA: 5s - loss: 0.7958 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.8027 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.8034 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.8117 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.8118 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.8164 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.8121 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.805110/27 [==========&gt;...................] - ETA: 3s - loss: 0.805611/27 [===========&gt;..................] - ETA: 3s - loss: 0.803012/27 [============&gt;.................] - ETA: 3s - loss: 0.799413/27 [=============&gt;................] - ETA: 2s - loss: 0.791914/27 [==============&gt;...............] - ETA: 2s - loss: 0.789015/27 [===============&gt;..............] - ETA: 2s - loss: 0.785916/27 [================&gt;.............] - ETA: 2s - loss: 0.779717/27 [=================&gt;............] - ETA: 2s - loss: 0.783618/27 [===================&gt;..........] - ETA: 1s - loss: 0.784219/27 [====================&gt;.........] - ETA: 1s - loss: 0.780220/27 [=====================&gt;........] - ETA: 1s - loss: 0.775721/27 [======================&gt;.......] - ETA: 1s - loss: 0.775522/27 [=======================&gt;......] - ETA: 1s - loss: 0.774323/27 [========================&gt;.....] - ETA: 0s - loss: 0.773024/27 [=========================&gt;....] - ETA: 0s - loss: 0.771325/27 [==========================&gt;...] - ETA: 0s - loss: 0.770526/27 [===========================&gt;..] - ETA: 0s - loss: 0.768627/27 [==============================] - ETA: 0s - loss: 0.768127/27 [==============================] - 6s 207ms/step - loss: 0.7681 - val_loss: 0.7077
Epoch 57/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.7508 2/27 [=&gt;............................] - ETA: 4s - loss: 0.7546 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.7378 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.7437 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.7290 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.7341 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.7243 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.7248 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.721910/27 [==========&gt;...................] - ETA: 3s - loss: 0.723611/27 [===========&gt;..................] - ETA: 3s - loss: 0.719812/27 [============&gt;.................] - ETA: 3s - loss: 0.719813/27 [=============&gt;................] - ETA: 2s - loss: 0.714814/27 [==============&gt;...............] - ETA: 2s - loss: 0.716415/27 [===============&gt;..............] - ETA: 2s - loss: 0.712216/27 [================&gt;.............] - ETA: 2s - loss: 0.710117/27 [=================&gt;............] - ETA: 2s - loss: 0.709518/27 [===================&gt;..........] - ETA: 1s - loss: 0.707319/27 [====================&gt;.........] - ETA: 1s - loss: 0.704520/27 [=====================&gt;........] - ETA: 1s - loss: 0.702921/27 [======================&gt;.......] - ETA: 1s - loss: 0.702822/27 [=======================&gt;......] - ETA: 1s - loss: 0.697423/27 [========================&gt;.....] - ETA: 0s - loss: 0.695624/27 [=========================&gt;....] - ETA: 0s - loss: 0.693425/27 [==========================&gt;...] - ETA: 0s - loss: 0.689926/27 [===========================&gt;..] - ETA: 0s - loss: 0.688527/27 [==============================] - ETA: 0s - loss: 0.687627/27 [==============================] - 6s 210ms/step - loss: 0.6876 - val_loss: 0.6505
Epoch 58/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.6477 2/27 [=&gt;............................] - ETA: 4s - loss: 0.6231 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.6384 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.6257 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.6339 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.6321 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.6258 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.6282 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.623910/27 [==========&gt;...................] - ETA: 3s - loss: 0.620111/27 [===========&gt;..................] - ETA: 3s - loss: 0.619312/27 [============&gt;.................] - ETA: 3s - loss: 0.620113/27 [=============&gt;................] - ETA: 2s - loss: 0.624114/27 [==============&gt;...............] - ETA: 2s - loss: 0.627615/27 [===============&gt;..............] - ETA: 2s - loss: 0.620516/27 [================&gt;.............] - ETA: 2s - loss: 0.624517/27 [=================&gt;............] - ETA: 2s - loss: 0.628218/27 [===================&gt;..........] - ETA: 1s - loss: 0.629419/27 [====================&gt;.........] - ETA: 1s - loss: 0.630720/27 [=====================&gt;........] - ETA: 1s - loss: 0.631821/27 [======================&gt;.......] - ETA: 1s - loss: 0.635522/27 [=======================&gt;......] - ETA: 1s - loss: 0.634623/27 [========================&gt;.....] - ETA: 0s - loss: 0.633624/27 [=========================&gt;....] - ETA: 0s - loss: 0.636025/27 [==========================&gt;...] - ETA: 0s - loss: 0.633126/27 [===========================&gt;..] - ETA: 0s - loss: 0.633127/27 [==============================] - ETA: 0s - loss: 0.634027/27 [==============================] - 6s 208ms/step - loss: 0.6340 - val_loss: 0.6623
Epoch 59/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.6963 2/27 [=&gt;............................] - ETA: 4s - loss: 0.6577 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.6404 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.6354 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.6338 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.6284 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.6236 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.6260 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.623410/27 [==========&gt;...................] - ETA: 3s - loss: 0.630911/27 [===========&gt;..................] - ETA: 3s - loss: 0.630612/27 [============&gt;.................] - ETA: 2s - loss: 0.632313/27 [=============&gt;................] - ETA: 2s - loss: 0.635414/27 [==============&gt;...............] - ETA: 2s - loss: 0.633215/27 [===============&gt;..............] - ETA: 2s - loss: 0.630116/27 [================&gt;.............] - ETA: 2s - loss: 0.631217/27 [=================&gt;............] - ETA: 1s - loss: 0.632618/27 [===================&gt;..........] - ETA: 1s - loss: 0.632819/27 [====================&gt;.........] - ETA: 1s - loss: 0.630520/27 [=====================&gt;........] - ETA: 1s - loss: 0.630221/27 [======================&gt;.......] - ETA: 1s - loss: 0.628422/27 [=======================&gt;......] - ETA: 0s - loss: 0.626623/27 [========================&gt;.....] - ETA: 0s - loss: 0.624824/27 [=========================&gt;....] - ETA: 0s - loss: 0.624825/27 [==========================&gt;...] - ETA: 0s - loss: 0.628526/27 [===========================&gt;..] - ETA: 0s - loss: 0.627327/27 [==============================] - ETA: 0s - loss: 0.626927/27 [==============================] - 6s 206ms/step - loss: 0.6269 - val_loss: 0.6273
Epoch 60/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.6076 2/27 [=&gt;............................] - ETA: 5s - loss: 0.6051 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5996 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.6117 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.6279 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.6258 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.6164 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.6181 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.608710/27 [==========&gt;...................] - ETA: 3s - loss: 0.609711/27 [===========&gt;..................] - ETA: 3s - loss: 0.609012/27 [============&gt;.................] - ETA: 3s - loss: 0.605013/27 [=============&gt;................] - ETA: 2s - loss: 0.603114/27 [==============&gt;...............] - ETA: 2s - loss: 0.603615/27 [===============&gt;..............] - ETA: 2s - loss: 0.605916/27 [================&gt;.............] - ETA: 2s - loss: 0.602817/27 [=================&gt;............] - ETA: 2s - loss: 0.602118/27 [===================&gt;..........] - ETA: 1s - loss: 0.596119/27 [====================&gt;.........] - ETA: 1s - loss: 0.596220/27 [=====================&gt;........] - ETA: 1s - loss: 0.598421/27 [======================&gt;.......] - ETA: 1s - loss: 0.598022/27 [=======================&gt;......] - ETA: 1s - loss: 0.596823/27 [========================&gt;.....] - ETA: 0s - loss: 0.596824/27 [=========================&gt;....] - ETA: 0s - loss: 0.598225/27 [==========================&gt;...] - ETA: 0s - loss: 0.598926/27 [===========================&gt;..] - ETA: 0s - loss: 0.599527/27 [==============================] - ETA: 0s - loss: 0.600227/27 [==============================] - 6s 208ms/step - loss: 0.6002 - val_loss: 0.5979
Epoch 61/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.5476 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5748 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5918 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5991 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5992 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5928 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5935 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5983 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.592010/27 [==========&gt;...................] - ETA: 3s - loss: 0.593711/27 [===========&gt;..................] - ETA: 3s - loss: 0.590912/27 [============&gt;.................] - ETA: 3s - loss: 0.591013/27 [=============&gt;................] - ETA: 2s - loss: 0.588314/27 [==============&gt;...............] - ETA: 2s - loss: 0.587415/27 [===============&gt;..............] - ETA: 2s - loss: 0.588616/27 [================&gt;.............] - ETA: 2s - loss: 0.591917/27 [=================&gt;............] - ETA: 2s - loss: 0.592618/27 [===================&gt;..........] - ETA: 1s - loss: 0.590519/27 [====================&gt;.........] - ETA: 1s - loss: 0.594920/27 [=====================&gt;........] - ETA: 1s - loss: 0.592921/27 [======================&gt;.......] - ETA: 1s - loss: 0.591222/27 [=======================&gt;......] - ETA: 1s - loss: 0.595223/27 [========================&gt;.....] - ETA: 0s - loss: 0.595224/27 [=========================&gt;....] - ETA: 0s - loss: 0.596725/27 [==========================&gt;...] - ETA: 0s - loss: 0.596426/27 [===========================&gt;..] - ETA: 0s - loss: 0.597927/27 [==============================] - ETA: 0s - loss: 0.597427/27 [==============================] - 6s 211ms/step - loss: 0.5974 - val_loss: 0.6171
Epoch 62/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.6617 2/27 [=&gt;............................] - ETA: 5s - loss: 0.6328 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.6140 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.6009 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.6010 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.6053 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.6050 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.6081 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.605910/27 [==========&gt;...................] - ETA: 3s - loss: 0.606811/27 [===========&gt;..................] - ETA: 3s - loss: 0.604912/27 [============&gt;.................] - ETA: 3s - loss: 0.606213/27 [=============&gt;................] - ETA: 2s - loss: 0.608414/27 [==============&gt;...............] - ETA: 2s - loss: 0.605415/27 [===============&gt;..............] - ETA: 2s - loss: 0.601616/27 [================&gt;.............] - ETA: 2s - loss: 0.599217/27 [=================&gt;............] - ETA: 2s - loss: 0.597618/27 [===================&gt;..........] - ETA: 1s - loss: 0.599919/27 [====================&gt;.........] - ETA: 1s - loss: 0.597020/27 [=====================&gt;........] - ETA: 1s - loss: 0.595921/27 [======================&gt;.......] - ETA: 1s - loss: 0.595822/27 [=======================&gt;......] - ETA: 1s - loss: 0.594923/27 [========================&gt;.....] - ETA: 0s - loss: 0.594524/27 [=========================&gt;....] - ETA: 0s - loss: 0.593825/27 [==========================&gt;...] - ETA: 0s - loss: 0.594126/27 [===========================&gt;..] - ETA: 0s - loss: 0.594827/27 [==============================] - ETA: 0s - loss: 0.594227/27 [==============================] - 6s 213ms/step - loss: 0.5942 - val_loss: 0.5953
Epoch 63/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5989 2/27 [=&gt;............................] - ETA: 4s - loss: 0.5767 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5705 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5842 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5824 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5819 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5838 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5868 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.584110/27 [==========&gt;...................] - ETA: 3s - loss: 0.585311/27 [===========&gt;..................] - ETA: 3s - loss: 0.582512/27 [============&gt;.................] - ETA: 3s - loss: 0.582613/27 [=============&gt;................] - ETA: 2s - loss: 0.583514/27 [==============&gt;...............] - ETA: 2s - loss: 0.582715/27 [===============&gt;..............] - ETA: 2s - loss: 0.584916/27 [================&gt;.............] - ETA: 2s - loss: 0.582017/27 [=================&gt;............] - ETA: 2s - loss: 0.582018/27 [===================&gt;..........] - ETA: 1s - loss: 0.582419/27 [====================&gt;.........] - ETA: 1s - loss: 0.582720/27 [=====================&gt;........] - ETA: 1s - loss: 0.584221/27 [======================&gt;.......] - ETA: 1s - loss: 0.582922/27 [=======================&gt;......] - ETA: 1s - loss: 0.584323/27 [========================&gt;.....] - ETA: 0s - loss: 0.582724/27 [=========================&gt;....] - ETA: 0s - loss: 0.581825/27 [==========================&gt;...] - ETA: 0s - loss: 0.580326/27 [===========================&gt;..] - ETA: 0s - loss: 0.582627/27 [==============================] - ETA: 0s - loss: 0.582727/27 [==============================] - 6s 207ms/step - loss: 0.5827 - val_loss: 0.5746
Epoch 64/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5792 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5836 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5813 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5733 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5691 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5732 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5806 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5820 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.584110/27 [==========&gt;...................] - ETA: 3s - loss: 0.585811/27 [===========&gt;..................] - ETA: 3s - loss: 0.585112/27 [============&gt;.................] - ETA: 2s - loss: 0.584213/27 [=============&gt;................] - ETA: 2s - loss: 0.579214/27 [==============&gt;...............] - ETA: 2s - loss: 0.577615/27 [===============&gt;..............] - ETA: 2s - loss: 0.577216/27 [================&gt;.............] - ETA: 2s - loss: 0.575517/27 [=================&gt;............] - ETA: 2s - loss: 0.573918/27 [===================&gt;..........] - ETA: 1s - loss: 0.571519/27 [====================&gt;.........] - ETA: 1s - loss: 0.572420/27 [=====================&gt;........] - ETA: 1s - loss: 0.572321/27 [======================&gt;.......] - ETA: 1s - loss: 0.571422/27 [=======================&gt;......] - ETA: 1s - loss: 0.572823/27 [========================&gt;.....] - ETA: 0s - loss: 0.571724/27 [=========================&gt;....] - ETA: 0s - loss: 0.573925/27 [==========================&gt;...] - ETA: 0s - loss: 0.570426/27 [===========================&gt;..] - ETA: 0s - loss: 0.572527/27 [==============================] - ETA: 0s - loss: 0.571527/27 [==============================] - 6s 208ms/step - loss: 0.5715 - val_loss: 0.5759
Epoch 65/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.6158 2/27 [=&gt;............................] - ETA: 5s - loss: 0.6062 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.6045 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5936 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5793 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5819 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5810 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5795 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.577510/27 [==========&gt;...................] - ETA: 3s - loss: 0.577511/27 [===========&gt;..................] - ETA: 3s - loss: 0.576212/27 [============&gt;.................] - ETA: 3s - loss: 0.577513/27 [=============&gt;................] - ETA: 2s - loss: 0.579014/27 [==============&gt;...............] - ETA: 2s - loss: 0.580515/27 [===============&gt;..............] - ETA: 2s - loss: 0.576016/27 [================&gt;.............] - ETA: 2s - loss: 0.574317/27 [=================&gt;............] - ETA: 1s - loss: 0.570818/27 [===================&gt;..........] - ETA: 1s - loss: 0.571319/27 [====================&gt;.........] - ETA: 1s - loss: 0.571020/27 [=====================&gt;........] - ETA: 1s - loss: 0.568721/27 [======================&gt;.......] - ETA: 1s - loss: 0.567922/27 [=======================&gt;......] - ETA: 1s - loss: 0.565423/27 [========================&gt;.....] - ETA: 0s - loss: 0.564224/27 [=========================&gt;....] - ETA: 0s - loss: 0.563725/27 [==========================&gt;...] - ETA: 0s - loss: 0.566126/27 [===========================&gt;..] - ETA: 0s - loss: 0.566627/27 [==============================] - ETA: 0s - loss: 0.566527/27 [==============================] - 6s 207ms/step - loss: 0.5665 - val_loss: 0.5581
Epoch 66/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.5468 2/27 [=&gt;............................] - ETA: 4s - loss: 0.5675 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5671 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5638 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5861 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5839 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5799 8/27 [=======&gt;......................] - ETA: 4s - loss: 0.5883 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.593810/27 [==========&gt;...................] - ETA: 3s - loss: 0.591511/27 [===========&gt;..................] - ETA: 3s - loss: 0.589112/27 [============&gt;.................] - ETA: 3s - loss: 0.592713/27 [=============&gt;................] - ETA: 3s - loss: 0.588314/27 [==============&gt;...............] - ETA: 2s - loss: 0.586815/27 [===============&gt;..............] - ETA: 2s - loss: 0.586816/27 [================&gt;.............] - ETA: 2s - loss: 0.582517/27 [=================&gt;............] - ETA: 2s - loss: 0.582218/27 [===================&gt;..........] - ETA: 1s - loss: 0.581319/27 [====================&gt;.........] - ETA: 1s - loss: 0.582120/27 [=====================&gt;........] - ETA: 1s - loss: 0.582921/27 [======================&gt;.......] - ETA: 1s - loss: 0.583722/27 [=======================&gt;......] - ETA: 1s - loss: 0.581823/27 [========================&gt;.....] - ETA: 0s - loss: 0.581324/27 [=========================&gt;....] - ETA: 0s - loss: 0.577125/27 [==========================&gt;...] - ETA: 0s - loss: 0.577226/27 [===========================&gt;..] - ETA: 0s - loss: 0.577727/27 [==============================] - ETA: 0s - loss: 0.578327/27 [==============================] - 6s 217ms/step - loss: 0.5783 - val_loss: 0.5593
Epoch 67/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5752 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5695 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5511 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5525 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5596 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5517 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5637 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5583 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.559210/27 [==========&gt;...................] - ETA: 3s - loss: 0.556311/27 [===========&gt;..................] - ETA: 3s - loss: 0.556812/27 [============&gt;.................] - ETA: 2s - loss: 0.556813/27 [=============&gt;................] - ETA: 2s - loss: 0.556414/27 [==============&gt;...............] - ETA: 2s - loss: 0.556315/27 [===============&gt;..............] - ETA: 2s - loss: 0.561716/27 [================&gt;.............] - ETA: 2s - loss: 0.562017/27 [=================&gt;............] - ETA: 1s - loss: 0.560918/27 [===================&gt;..........] - ETA: 1s - loss: 0.563119/27 [====================&gt;.........] - ETA: 1s - loss: 0.559020/27 [=====================&gt;........] - ETA: 1s - loss: 0.559021/27 [======================&gt;.......] - ETA: 1s - loss: 0.557522/27 [=======================&gt;......] - ETA: 0s - loss: 0.559923/27 [========================&gt;.....] - ETA: 0s - loss: 0.561624/27 [=========================&gt;....] - ETA: 0s - loss: 0.561425/27 [==========================&gt;...] - ETA: 0s - loss: 0.560626/27 [===========================&gt;..] - ETA: 0s - loss: 0.563527/27 [==============================] - ETA: 0s - loss: 0.563327/27 [==============================] - 6s 207ms/step - loss: 0.5633 - val_loss: 0.5524
Epoch 68/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.5510 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5362 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5440 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5494 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5481 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5516 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5467 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5461 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.547510/27 [==========&gt;...................] - ETA: 3s - loss: 0.545111/27 [===========&gt;..................] - ETA: 3s - loss: 0.547912/27 [============&gt;.................] - ETA: 3s - loss: 0.554813/27 [=============&gt;................] - ETA: 2s - loss: 0.554714/27 [==============&gt;...............] - ETA: 2s - loss: 0.557015/27 [===============&gt;..............] - ETA: 2s - loss: 0.556916/27 [================&gt;.............] - ETA: 2s - loss: 0.556817/27 [=================&gt;............] - ETA: 2s - loss: 0.556718/27 [===================&gt;..........] - ETA: 1s - loss: 0.555919/27 [====================&gt;.........] - ETA: 1s - loss: 0.556020/27 [=====================&gt;........] - ETA: 1s - loss: 0.555621/27 [======================&gt;.......] - ETA: 1s - loss: 0.552622/27 [=======================&gt;......] - ETA: 1s - loss: 0.553723/27 [========================&gt;.....] - ETA: 0s - loss: 0.552924/27 [=========================&gt;....] - ETA: 0s - loss: 0.551325/27 [==========================&gt;...] - ETA: 0s - loss: 0.551326/27 [===========================&gt;..] - ETA: 0s - loss: 0.550427/27 [==============================] - ETA: 0s - loss: 0.552027/27 [==============================] - 6s 207ms/step - loss: 0.5520 - val_loss: 0.5483
Epoch 69/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5530 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5762 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5721 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5800 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5821 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5661 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5608 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5481 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.549010/27 [==========&gt;...................] - ETA: 3s - loss: 0.548511/27 [===========&gt;..................] - ETA: 3s - loss: 0.550712/27 [============&gt;.................] - ETA: 2s - loss: 0.547513/27 [=============&gt;................] - ETA: 2s - loss: 0.545514/27 [==============&gt;...............] - ETA: 2s - loss: 0.542715/27 [===============&gt;..............] - ETA: 2s - loss: 0.543916/27 [================&gt;.............] - ETA: 2s - loss: 0.544317/27 [=================&gt;............] - ETA: 1s - loss: 0.544118/27 [===================&gt;..........] - ETA: 1s - loss: 0.542319/27 [====================&gt;.........] - ETA: 1s - loss: 0.544320/27 [=====================&gt;........] - ETA: 1s - loss: 0.541521/27 [======================&gt;.......] - ETA: 1s - loss: 0.541622/27 [=======================&gt;......] - ETA: 0s - loss: 0.542723/27 [========================&gt;.....] - ETA: 0s - loss: 0.541824/27 [=========================&gt;....] - ETA: 0s - loss: 0.543525/27 [==========================&gt;...] - ETA: 0s - loss: 0.545926/27 [===========================&gt;..] - ETA: 0s - loss: 0.547327/27 [==============================] - ETA: 0s - loss: 0.547827/27 [==============================] - 6s 206ms/step - loss: 0.5478 - val_loss: 0.5329
Epoch 70/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5549 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5480 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5435 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5429 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5584 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5713 7/27 [======&gt;.......................] - ETA: 3s - loss: 0.5680 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5696 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.563010/27 [==========&gt;...................] - ETA: 3s - loss: 0.549011/27 [===========&gt;..................] - ETA: 3s - loss: 0.550612/27 [============&gt;.................] - ETA: 2s - loss: 0.553113/27 [=============&gt;................] - ETA: 2s - loss: 0.551414/27 [==============&gt;...............] - ETA: 2s - loss: 0.551415/27 [===============&gt;..............] - ETA: 2s - loss: 0.548116/27 [================&gt;.............] - ETA: 2s - loss: 0.543017/27 [=================&gt;............] - ETA: 1s - loss: 0.541118/27 [===================&gt;..........] - ETA: 1s - loss: 0.543019/27 [====================&gt;.........] - ETA: 1s - loss: 0.538520/27 [=====================&gt;........] - ETA: 1s - loss: 0.540221/27 [======================&gt;.......] - ETA: 1s - loss: 0.541022/27 [=======================&gt;......] - ETA: 0s - loss: 0.540623/27 [========================&gt;.....] - ETA: 0s - loss: 0.541224/27 [=========================&gt;....] - ETA: 0s - loss: 0.539825/27 [==========================&gt;...] - ETA: 0s - loss: 0.540426/27 [===========================&gt;..] - ETA: 0s - loss: 0.543927/27 [==============================] - ETA: 0s - loss: 0.544427/27 [==============================] - 6s 206ms/step - loss: 0.5444 - val_loss: 0.5303
Epoch 71/200
 1/27 [&gt;.............................] - ETA: 4s - loss: 0.5154 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5220 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5161 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5331 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5365 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5316 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5379 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5413 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.544510/27 [==========&gt;...................] - ETA: 3s - loss: 0.545511/27 [===========&gt;..................] - ETA: 3s - loss: 0.544112/27 [============&gt;.................] - ETA: 3s - loss: 0.544713/27 [=============&gt;................] - ETA: 2s - loss: 0.547414/27 [==============&gt;...............] - ETA: 2s - loss: 0.547615/27 [===============&gt;..............] - ETA: 2s - loss: 0.547316/27 [================&gt;.............] - ETA: 2s - loss: 0.551417/27 [=================&gt;............] - ETA: 2s - loss: 0.555018/27 [===================&gt;..........] - ETA: 1s - loss: 0.557519/27 [====================&gt;.........] - ETA: 1s - loss: 0.557520/27 [=====================&gt;........] - ETA: 1s - loss: 0.559521/27 [======================&gt;.......] - ETA: 1s - loss: 0.560522/27 [=======================&gt;......] - ETA: 1s - loss: 0.556923/27 [========================&gt;.....] - ETA: 0s - loss: 0.557324/27 [=========================&gt;....] - ETA: 0s - loss: 0.555825/27 [==========================&gt;...] - ETA: 0s - loss: 0.554026/27 [===========================&gt;..] - ETA: 0s - loss: 0.555627/27 [==============================] - ETA: 0s - loss: 0.555627/27 [==============================] - 6s 209ms/step - loss: 0.5556 - val_loss: 0.5949
Epoch 72/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.6192 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5919 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5656 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5679 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5689 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5668 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5604 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5592 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.561510/27 [==========&gt;...................] - ETA: 3s - loss: 0.557911/27 [===========&gt;..................] - ETA: 3s - loss: 0.561612/27 [============&gt;.................] - ETA: 3s - loss: 0.552413/27 [=============&gt;................] - ETA: 2s - loss: 0.558514/27 [==============&gt;...............] - ETA: 2s - loss: 0.557615/27 [===============&gt;..............] - ETA: 2s - loss: 0.559716/27 [================&gt;.............] - ETA: 2s - loss: 0.557517/27 [=================&gt;............] - ETA: 2s - loss: 0.557418/27 [===================&gt;..........] - ETA: 1s - loss: 0.557919/27 [====================&gt;.........] - ETA: 1s - loss: 0.558320/27 [=====================&gt;........] - ETA: 1s - loss: 0.560021/27 [======================&gt;.......] - ETA: 1s - loss: 0.560022/27 [=======================&gt;......] - ETA: 1s - loss: 0.561323/27 [========================&gt;.....] - ETA: 0s - loss: 0.559524/27 [=========================&gt;....] - ETA: 0s - loss: 0.562225/27 [==========================&gt;...] - ETA: 0s - loss: 0.562526/27 [===========================&gt;..] - ETA: 0s - loss: 0.563327/27 [==============================] - ETA: 0s - loss: 0.562527/27 [==============================] - 6s 209ms/step - loss: 0.5625 - val_loss: 0.5420
Epoch 73/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5819 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5532 3/27 [==&gt;...........................] - ETA: 5s - loss: 0.5439 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5476 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5406 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5480 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5450 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5429 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.543210/27 [==========&gt;...................] - ETA: 3s - loss: 0.542811/27 [===========&gt;..................] - ETA: 3s - loss: 0.538112/27 [============&gt;.................] - ETA: 3s - loss: 0.538113/27 [=============&gt;................] - ETA: 2s - loss: 0.539214/27 [==============&gt;...............] - ETA: 2s - loss: 0.538015/27 [===============&gt;..............] - ETA: 2s - loss: 0.536716/27 [================&gt;.............] - ETA: 2s - loss: 0.537017/27 [=================&gt;............] - ETA: 2s - loss: 0.533818/27 [===================&gt;..........] - ETA: 1s - loss: 0.530419/27 [====================&gt;.........] - ETA: 1s - loss: 0.528820/27 [=====================&gt;........] - ETA: 1s - loss: 0.531721/27 [======================&gt;.......] - ETA: 1s - loss: 0.530622/27 [=======================&gt;......] - ETA: 1s - loss: 0.530223/27 [========================&gt;.....] - ETA: 0s - loss: 0.531324/27 [=========================&gt;....] - ETA: 0s - loss: 0.532325/27 [==========================&gt;...] - ETA: 0s - loss: 0.531826/27 [===========================&gt;..] - ETA: 0s - loss: 0.530227/27 [==============================] - ETA: 0s - loss: 0.530927/27 [==============================] - 6s 211ms/step - loss: 0.5309 - val_loss: 0.4947
Epoch 74/200
 1/27 [&gt;.............................] - ETA: 5s - loss: 0.5058 2/27 [=&gt;............................] - ETA: 5s - loss: 0.5495 3/27 [==&gt;...........................] - ETA: 4s - loss: 0.5501 4/27 [===&gt;..........................] - ETA: 4s - loss: 0.5448 5/27 [====&gt;.........................] - ETA: 4s - loss: 0.5485 6/27 [=====&gt;........................] - ETA: 4s - loss: 0.5521 7/27 [======&gt;.......................] - ETA: 4s - loss: 0.5532 8/27 [=======&gt;......................] - ETA: 3s - loss: 0.5529 9/27 [=========&gt;....................] - ETA: 3s - loss: 0.552610/27 [==========&gt;...................] - ETA: 3s - loss: 0.548411/27 [===========&gt;..................] - ETA: 3s - loss: 0.549712/27 [============&gt;.................] - ETA: 3s - loss: 0.541813/27 [=============&gt;................] - ETA: 2s - loss: 0.537514/27 [==============&gt;...............] - ETA: 2s - loss: 0.533015/27 [===============&gt;..............] - ETA: 2s - loss: 0.529716/27 [================&gt;.............] - ETA: 2s - loss: 0.531317/27 [=================&gt;............] - ETA: 2s - loss: 0.529918/27 [===================&gt;..........] - ETA: 1s - loss: 0.527419/27 [====================&gt;.........] - ETA: 1s - loss: 0.527420/27 [=====================&gt;........] - ETA: 1s - loss: 0.523921/27 [======================&gt;.......] - ETA: 1s - loss: 0.523022/27 [=======================&gt;......] - ETA: 1s - loss: 0.521923/27 [========================&gt;.....] - ETA: 0s - loss: 0.519524/27 [=========================&gt;....] - ETA: 0s - loss: 0.518925/27 [==========================&gt;...] - ETA: 0s - loss: 0.516126/27 [===========================&gt;..] - ETA: 0s - loss: 0.515627/27 [==============================] - ETA: 0s - loss: 0.514827/27 [==============================] - 6s 210ms/step - loss: 0.5148 - val_loss: 0.4620</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>&lt;matplotlib.legend.Legend at 0x24761d5e760&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-8-output-3.png" width="571" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get train MAE loss.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x_train_pred <span class="op">=</span> model.predict(x_train)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>train_mae_loss <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(x_train_pred <span class="op">-</span> x_train), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.hist(train_mae_loss, bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Train MAE loss"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"No of samples"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get reconstruction loss threshold.</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> np.<span class="bu">max</span>(train_mae_loss)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Reconstruction error threshold: "</span>, threshold)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  1/117 [..............................] - ETA: 1:28  3/117 [..............................] - ETA: 3s    5/117 [&gt;.............................] - ETA: 3s  7/117 [&gt;.............................] - ETA: 3s  9/117 [=&gt;............................] - ETA: 3s 11/117 [=&gt;............................] - ETA: 3s 13/117 [==&gt;...........................] - ETA: 3s 15/117 [==&gt;...........................] - ETA: 3s 17/117 [===&gt;..........................] - ETA: 3s 19/117 [===&gt;..........................] - ETA: 3s 21/117 [====&gt;.........................] - ETA: 3s 23/117 [====&gt;.........................] - ETA: 3s 25/117 [=====&gt;........................] - ETA: 2s 27/117 [=====&gt;........................] - ETA: 2s 29/117 [======&gt;.......................] - ETA: 2s 31/117 [======&gt;.......................] - ETA: 2s 33/117 [=======&gt;......................] - ETA: 2s 35/117 [=======&gt;......................] - ETA: 2s 37/117 [========&gt;.....................] - ETA: 2s 39/117 [=========&gt;....................] - ETA: 2s 41/117 [=========&gt;....................] - ETA: 2s 43/117 [==========&gt;...................] - ETA: 2s 45/117 [==========&gt;...................] - ETA: 2s 47/117 [===========&gt;..................] - ETA: 2s 49/117 [===========&gt;..................] - ETA: 2s 51/117 [============&gt;.................] - ETA: 2s 53/117 [============&gt;.................] - ETA: 2s 55/117 [=============&gt;................] - ETA: 2s 57/117 [=============&gt;................] - ETA: 1s 59/117 [==============&gt;...............] - ETA: 1s 61/117 [==============&gt;...............] - ETA: 1s 63/117 [===============&gt;..............] - ETA: 1s 65/117 [===============&gt;..............] - ETA: 1s 67/117 [================&gt;.............] - ETA: 1s 69/117 [================&gt;.............] - ETA: 1s 71/117 [=================&gt;............] - ETA: 1s 73/117 [=================&gt;............] - ETA: 1s 75/117 [==================&gt;...........] - ETA: 1s 77/117 [==================&gt;...........] - ETA: 1s 79/117 [===================&gt;..........] - ETA: 1s 81/117 [===================&gt;..........] - ETA: 1s 83/117 [====================&gt;.........] - ETA: 1s 85/117 [====================&gt;.........] - ETA: 1s 87/117 [=====================&gt;........] - ETA: 0s 89/117 [=====================&gt;........] - ETA: 0s 91/117 [======================&gt;.......] - ETA: 0s 93/117 [======================&gt;.......] - ETA: 0s 95/117 [=======================&gt;......] - ETA: 0s 97/117 [=======================&gt;......] - ETA: 0s 99/117 [========================&gt;.....] - ETA: 0s101/117 [========================&gt;.....] - ETA: 0s103/117 [=========================&gt;....] - ETA: 0s105/117 [=========================&gt;....] - ETA: 0s107/117 [==========================&gt;...] - ETA: 0s109/117 [==========================&gt;...] - ETA: 0s111/117 [===========================&gt;..] - ETA: 0s113/117 [===========================&gt;..] - ETA: 0s115/117 [============================&gt;.] - ETA: 0s117/117 [==============================] - ETA: 0s117/117 [==============================] - 5s 33ms/step
Reconstruction error threshold:  0.9511219791791109</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-9-output-2.png" width="593" height="429"></p>
</div>
</div>
</section>
<section id="preparing-test-data-and-plotting-anomalies" class="level1">
<h1>Preparing Test Data and Plotting Anomalies</h1>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_test(values, mean, std):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    values <span class="op">-=</span> mean</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    values <span class="op">/=</span> std</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> values</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>test_value <span class="op">=</span> get_value_from_df(df_daily_jumpsup)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>test_value <span class="op">=</span> normalize_test(test_value, training_mean, training_std)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plt.plot(test_value.tolist())</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-10-output-1.png" width="569" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequences from test values.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> create_sequences(test_value)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test input shape: "</span>, x_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test input shape:  (3744, 288, 1)</code></pre>
</div>
</div>
<p>Test input shape: (3744, 288, 1)</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get test MAE loss.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x_test_pred <span class="op">=</span> model.predict(x_test)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>test_mae_loss <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(x_test_pred <span class="op">-</span> x_test), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>test_mae_loss <span class="op">=</span> test_mae_loss.reshape((<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.hist(test_mae_loss, bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"test MAE loss"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"No of samples"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  1/117 [..............................] - ETA: 6s  3/117 [..............................] - ETA: 3s  5/117 [&gt;.............................] - ETA: 3s  7/117 [&gt;.............................] - ETA: 3s  9/117 [=&gt;............................] - ETA: 3s 11/117 [=&gt;............................] - ETA: 3s 13/117 [==&gt;...........................] - ETA: 3s 15/117 [==&gt;...........................] - ETA: 3s 17/117 [===&gt;..........................] - ETA: 3s 19/117 [===&gt;..........................] - ETA: 3s 21/117 [====&gt;.........................] - ETA: 3s 23/117 [====&gt;.........................] - ETA: 2s 25/117 [=====&gt;........................] - ETA: 2s 28/117 [======&gt;.......................] - ETA: 2s 30/117 [======&gt;.......................] - ETA: 2s 32/117 [=======&gt;......................] - ETA: 2s 34/117 [=======&gt;......................] - ETA: 2s 36/117 [========&gt;.....................] - ETA: 2s 38/117 [========&gt;.....................] - ETA: 2s 40/117 [=========&gt;....................] - ETA: 2s 42/117 [=========&gt;....................] - ETA: 2s 44/117 [==========&gt;...................] - ETA: 2s 46/117 [==========&gt;...................] - ETA: 2s 48/117 [===========&gt;..................] - ETA: 2s 50/117 [===========&gt;..................] - ETA: 2s 52/117 [============&gt;.................] - ETA: 2s 54/117 [============&gt;.................] - ETA: 1s 56/117 [=============&gt;................] - ETA: 1s 58/117 [=============&gt;................] - ETA: 1s 60/117 [==============&gt;...............] - ETA: 1s 62/117 [==============&gt;...............] - ETA: 1s 64/117 [===============&gt;..............] - ETA: 1s 66/117 [===============&gt;..............] - ETA: 1s 68/117 [================&gt;.............] - ETA: 1s 70/117 [================&gt;.............] - ETA: 1s 72/117 [=================&gt;............] - ETA: 1s 74/117 [=================&gt;............] - ETA: 1s 76/117 [==================&gt;...........] - ETA: 1s 78/117 [===================&gt;..........] - ETA: 1s 80/117 [===================&gt;..........] - ETA: 1s 82/117 [====================&gt;.........] - ETA: 1s 84/117 [====================&gt;.........] - ETA: 1s 86/117 [=====================&gt;........] - ETA: 0s 88/117 [=====================&gt;........] - ETA: 0s 90/117 [======================&gt;.......] - ETA: 0s 92/117 [======================&gt;.......] - ETA: 0s 94/117 [=======================&gt;......] - ETA: 0s 96/117 [=======================&gt;......] - ETA: 0s 98/117 [========================&gt;.....] - ETA: 0s100/117 [========================&gt;.....] - ETA: 0s102/117 [=========================&gt;....] - ETA: 0s104/117 [=========================&gt;....] - ETA: 0s106/117 [==========================&gt;...] - ETA: 0s108/117 [==========================&gt;...] - ETA: 0s110/117 [===========================&gt;..] - ETA: 0s112/117 [===========================&gt;..] - ETA: 0s114/117 [============================&gt;.] - ETA: 0s116/117 [============================&gt;.] - ETA: 0s117/117 [==============================] - 4s 32ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-12-output-2.png" width="600" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect all the samples which are anomalies.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>anomalies <span class="op">=</span> (test_mae_loss <span class="op">&gt;</span> threshold).tolist()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of anomaly samples: "</span>, np.<span class="bu">sum</span>(anomalies))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of anomaly samples:  272</code></pre>
</div>
</div>
</section>
<section id="overlay-anomaly-over-test-data" class="level1">
<h1>Overlay Anomaly over Test Data</h1>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>anomalous_data_indices <span class="op">=</span> []</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> data_idx <span class="kw">in</span> <span class="bu">range</span>(TIME_STEPS <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(test_value) <span class="op">-</span> TIME_STEPS <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    time_series <span class="op">=</span> <span class="bu">range</span>(data_idx <span class="op">-</span> TIME_STEPS <span class="op">+</span> <span class="dv">1</span>, data_idx)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">all</span>([anomalies[j] <span class="cf">for</span> j <span class="kw">in</span> time_series]):</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        anomalous_data_indices.append(data_idx)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>df_subset <span class="op">=</span> df_daily_jumpsup.iloc[anomalous_data_indices, :]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(bottom<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.gca()</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>xfmt <span class="op">=</span> md.DateFormatter(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(xfmt)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> df_daily_jumpsup[<span class="st">"timestamp"</span>].to_list()</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> [datetime.strptime(x, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>) <span class="cf">for</span> x <span class="kw">in</span> dates]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> df_daily_jumpsup[<span class="st">"value"</span>].to_list()</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>plt.plot(dates, values, label<span class="op">=</span><span class="st">"test data"</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> df_subset[<span class="st">"timestamp"</span>].to_list()</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> [datetime.strptime(x, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>) <span class="cf">for</span> x <span class="kw">in</span> dates]</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> df_subset[<span class="st">"value"</span>].to_list()</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>plt.plot(dates, values, label<span class="op">=</span><span class="st">"anomalies"</span>, color<span class="op">=</span><span class="st">"r"</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-14-output-1.png" width="626" height="426"></p>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>The script identifies anomalies as data points with a reconstruction error surpassing the specified threshold. Furthermore, it showcases the assessment of the model’s learning by comparing the original and predicted sequences for a sample from the training data. This step aids in understanding how effectively the model has learned to reconstruct normal data. Additionally, the script illustrates the normalization of the test data using the mean and standard deviation derived from the training data. This normalization is crucial because the model was trained on normalized data, ensuring that the test data is normalized in the same manner for the model to make accurate predictions. This consistency in normalization is vital for the model’s effectiveness in handling unseen data. <a href="https://github.com/Sree4587/sree4587.github.io/blob/main/posts/Blog5/index.qmd">SOURCE</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>